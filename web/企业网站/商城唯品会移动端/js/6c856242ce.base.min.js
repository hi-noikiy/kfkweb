function setBackAct(a) {
    var b = "";
    switch (a) {
        case"topHeaderUserHome":
            b = "member_index.html";
            break;
        case"topHeaderCart":
            b = "cart.html";
            break;
        case"topHeaderLogistics":
            b = "member_order_list.html"
    }
    "" != b && (document.cookie = "WAP[back_act]=" + b)
}
function trim_str(a) {
    return"string" == typeof a ? a.replace(/^\s*|\s*$/g, "") : a
}
function getShopArea(a, b) {
    var c = a.options, d = 0;
    if (null == c)
        return!1;
    for (var e = null, f = 0; f < c.length; f++)
        if (1 == c[f].selected) {
            e = c[f].value;
            break
        }
    if (0 === parseInt(e) && !parseInt(e))
        return!1;
    if ("" != d && d > 0)
        var g = {url: "ajaxapi-address4level.html?" + (new Date).getTime(), data: {type: b, id: e, chkwh: d}, dataType: "json", type: "Get"};
    else
        var g = {url: "ajaxapi-address4level.html?" + (new Date).getTime(), data: {type: b, id: e}, dataType: "json", type: "Get"};
    g.error = function() {
        dialog.black("网络延时，请刷新页面重试")
    }, g.success = function(a) {
        if (a && null != a && void 0 != a) {
            var c = '<option value="0">请选择</option>';
            if ("city" == b) {
                for (var d = 0; d < a.length; d++)
                    a[d].city_id && a[d].city_name && (c += '<option value="' + a[d].city_id + '">' + a[d].city_name + "</option>");
                $("#district").html('<option value="0">请选择</option>'), $("#street").html('<option value="0">请选择</option>')
            } else if ("district" == b) {
                for (var d = 0; d < a.length; d++)
                    a[d].district_id && a[d].district_name && (c += '<option value="' + a[d].district_id + '">' + a[d].district_name + "</option>");
                $("#street").html('<option value="0">请选择</option>')
            } else if ("street" == b)
                if (a.length > 0)
                    for (var d = 0; d < a.length; d++)
                        a[d].street_id && a[d].street_name && (c += '<option value="' + a[d].street_id + '">' + a[d].street_name + "</option>");
                else
                    c = '<option value="-1">无</option>';
            $("#" + b).html(c)
        } else
            dialog.black("网络延时，请刷新页面重试")
    }, $.ajax(g)
}
function getPostcode() {
    var a = $("#district").val();
    0 == a ? dialog.black("请选择区") : $.ajax({url: "ajaxapi-getPostCode.html?" + (new Date).getTime(), data: "district=" + a, type: "POST", dataType: "json", success: function(a) {
            "-1" == a.code ? dialog.black("请选择区") : $("#postcode").val(a.zipcode)
        }})
}
function revision_change(a) {
    "HD" == a ? $.get("index.php?m=ajax&act=revision", {hd: 1}, function(a) {
        if (1 == a.code) {
            var b = '<a href="javascript:void(0)" onclick="revision_change(\'\')"><span class="">触屏</span><span class="cur">高清</span></a>';
            $("#header .head_left.revision_change") && $("#header .head_left.revision_change").html(b), setTimeout(function() {
                window.location.reload()
            }, 2e3), VsmCart.VsmDialog("正在切换到高清版", {setClass: "ui-info", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3})
        }
    }, "json") : $.get("index.php?m=ajax&act=revision", {hd: 0}, function(a) {
        if (1 == a.code) {
            var b = '<a href="javascript:void(0)" onclick="revision_change(\'HD\')"><span class="cur">触屏</span><span class="">高清</span></a>';
            $("#header .head_left.revision_change") && $("#header .head_left.revision_change").html(b), setTimeout(function() {
                window.location.reload()
            }, 2e3), VsmCart.VsmDialog("正在切换到触屏版", {setClass: "ui-info", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3})
        }
    }, "json")
}
function shakeScroll(a, b, c, d) {
    window.scroll(0, a.offsetTop - 40), a = a.children[c];
    var e = arguments[4] ? arguments[4] : 200, f = 0, g = !1, h = a.className, i = "", d = d || 2;
    g || (g = setInterval(function() {
        f++, i = f % 2 ? h + " " + b : h, a.className = i, f == 2 * d && (clearInterval(g), a.className = h)
    }, e))
}
function download(a, b, c) {
    return a.length < 1 || b.length < 1 ? !1 : void $.post("index.php?m=service&service=download", {client: a, platform: b}, function(a) {
        1 == a && (location.href = c)
    }, "json")
}
function grab_red_packet() {
    $.get("index.php?m=lottery&act=gograb", {}, function(a) {
        null != a && (1 == a.error && a.url ? location.href = a.url : a.content && ($(".envelope_step1").css("display", "none"), $(".envelope_step2").html(a.content), $("#mobile").select()))
    }, "json")
}
function verificode() {
    var a = document.getElementById("mobile").value, b = /^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/;
    if (!b.test(a))
        return dialog.black("手机号码错误：手机号码格式不正确"), document.getElementById("mobile").select(), !1;
    var c = document.getElementById("lottery_fc").value;
    $("#getcode").val("验证码获取中"), $.get("index.php?m=lottery&act=getcode", {mobile: a, from: c}, function(a) {
        1 == a.error ? VsmCart.VsmDialog(a.description, {setClass: "ui-error", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3}) : 1 == a.status ? (VsmCart.VsmDialog("验证码发送成功，请注意查收短信", {setClass: "ui-success", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3}), document.getElementById("referrer_uid").value = a.referrer_uid, a.veriCode && null != a.veriCode && (document.getElementById("code").value = a.veriCode)) : 0 == a.status && dialog.black(a.description), $("#getcode").val("获取验证码")
    }, "json")
}
function chk_verificode() {
    var a = document.getElementById("mobile").value, b = document.getElementById("code").value, c = document.getElementById("referrer_uid").value, d = document.getElementById("lottery_fc").value, e = /^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/;
    return e.test(a) ? b.length < 4 ? (dialog.black("验证码错误"), document.getElementById("code").select(), !1) : ($("#subcode").val("领取中"), void $.get("index.php?m=lottery&act=chkcode", {mobile: a, code: b, referrer_uid: c, from: d}, function(a) {
        1 == a.error ? dialog.black(a.description) : 1 == a.status ? (a.favourable && (VsmCart.VsmDialog("恭喜您获得" + a.favourable.money + "元红包", {setClass: "ui-success", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3}), $(".dc_share .fblod").text("恭喜您获得" + a.favourable.money + "元红包！")), $(".sharetofrieds span").text(a.domain + "?a=" + a.encryptedUserId), $("#encryptedUserId").val(a.encryptedUserId), $("#favourable_amount").val(a.favourable_amount), $(".downline").html(a.output), $(".dc_share").css("display", ""), $(".envelope_step2").html("")) : 0 == a.status && dialog.black(a.description), $("#subcode").val("领取福包")
    }, "json")) : (dialog.black("手机号码错误：手机号码格式不正确"), document.getElementById("mobile").select(), !1)
}
function dragon_sign() {
    $.get("index.php?m=sign&act=sign", {}, function(a) {
        if (1 == a.error && a.url)
            return location.href = a.url, !1;
        if ((1 == a.sign_status || 1 == a.today_is_signed) && $("#sing_step1").hide(), a.sign_status ? a.total_sign && (a.total_sign < 5 ? $("#total_sign").html(a.total_sign) : $("#sign_msg").html('您已签到<b class="c-red">5</b>天啦!<br> 有机会赢得<span class="fontbg">719当天全额免单</span>！<br/>8月2日公布，敬请期待~')) : a.description && ($("#sign_msg").html(a.description), $("#sign_msg").css("display", "")), $(".sing_step2").css("display", ""), a.signs) {
            for (var b = "<tr><th>日期</th><th>签到时间</th></tr>", c = 0; c < a.signs.length; c++)
                b += "<tr><td>" + a.signs[c].date + "</td><td>" + a.signs[c].time + "</td></tr>";
            $("#mysignbook").show(), $("#mysignbook table").html(b)
        }
    }, "json")
}
function private_check_code(a) {
    var b = document.getElementById("verify_code").value, c = a;
    return b ? ($("#submit").val("验证中..."), void $.post("index.php?m=private", {verify_code: b}, function(a) {
        $("#submit").val("立即进场"), "1" == a.code ? VsmCart.VsmDialog(a.msg, {setClass: "ui-success", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3}) : "0" == a.code && (VsmCart.VsmDialog(a.msg + "3秒后将为您跳到专场页面", {setClass: "ui-info", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3}), setTimeout(function() {
            window.location.href = "brand-index-" + c + "-0-1-10-0-0-1-0-0.html?m=brand&brand_id=" + c
        }, 3e3))
    }, "json")) : (dialog.black("验证码不能为空"), !1)
}
function getLocalStorageItem() {
    if (window.localStorage) {
        var a = localStorage.getItem("emptycart");
        return a = parseInt(a), window.android.getLocalStorage(a)
    }
}
function rssByMobile() {
    var a = document.getElementById("mobile").value, b = /^13[0-9]{9}$|14[0-9]{9}|15[0-9]{9}$|18[0-9]{9}$/;
    return b.test(a) ? void $.get("activitysys-915-list.html?do=rss", {mobile: a}, function(a) {
        500 == a.code ? alert(a.msg) : 200 == a.code && alert(a.msg)
    }, "json") : (dialog.black("手机号码格式不正确"), !1)
}
function empty_text() {
    var a = $(this), b = a.prev().find("input");
    b.val() && b.val("")
}
function auth_data(a, b, c) {
    var d = "", e = Date.parse(new Date) / 1e3, d = rstr2b64(a) + ":" + rstr2b64(e.toString()) + ":" + rstr2b64(b), c = arguments[2] ? arguments[2] : "";
    return c.length > 0 && (d += ":" + rstr2b64(c)), d
}
!function(a, b, c, d) {
    var e = a(b);
    a.fn.lazyload = function(f) {
        function g() {
            var b = 0;
            k.each(function() {
                var c = a(this);
                if (!l.skip_invisible || c.is(":visible"))
                    if (a.abovethetop(this, l) || a.leftofbegin(this, l))
                        ;
                    else if (a.belowthefold(this, l) || a.rightoffold(this, l)) {
                        if (++b > l.failure_limit)
                            return!1
                    } else
                        c.trigger("appear"), b = 0
            })
        }
        function h(a) {
            return a && a.width > 1 && a.height > 1
        }
        function i(b) {
            var c = a.trim(b.attr("data-" + l.error_attribute));
            c && a("<img />").bind("load", function() {
                b.hide().attr("src", c)[l.effect](l.effect_speed)
            }).attr("src", c)
        }
        var j, k = this, l = {threshold: 0, failure_limit: 0, event: "scroll", effect: "show", container: b, data_attribute: "original", error_attribute: "onerror", skip_invisible: !0, appear: null, load: null, placeholder: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};
        return f && (d !== f.failurelimit && (f.failure_limit = f.failurelimit, delete f.failurelimit), d !== f.effectspeed && (f.effect_speed = f.effectspeed, delete f.effectspeed), a.extend(l, f)), j = l.container === d || l.container === b ? e : a(l.container), 0 === l.event.indexOf("scroll") && j.bind(l.event, function() {
            return g()
        }), this.each(function() {
            var b = this, c = a(b);
            b.loaded = !1, (c.attr("src") === d || c.attr("src") === !1) && c.is("img") && c.attr("src", l.placeholder), c.one("appear", function() {
                if (!this.loaded) {
                    if (l.appear) {
                        var d = k.length;
                        l.appear.call(b, d, l)
                    }
                    a("<img />").bind("load", function() {
                        var d = c.attr("data-" + l.data_attribute);
                        c.hide(), c.is("img") ? c.attr("src", d) : c.css("background-image", "url('" + d + "')"), c[l.effect](l.effect_speed), b.loaded = !0;
                        var e = a.grep(k, function(a) {
                            return!a.loaded
                        });
                        if (k = a(e), l.load) {
                            var f = k.length;
                            l.load.call(b, f, l)
                        }
                        h(this) || i(c)
                    }).bind("error", function() {
                        i(c)
                    }).attr("src", c.attr("data-" + l.data_attribute))
                }
            }), 0 !== l.event.indexOf("scroll") && c.bind(l.event, function() {
                b.loaded || c.trigger("appear")
            })
        }), e.bind("resize", function() {
            g()
        }), /(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion) && e.bind("pageshow", function(b) {
            b.originalEvent && b.originalEvent.persisted && k.each(function() {
                a(this).trigger("appear")
            })
        }), a(c).ready(function() {
            g()
        }), this
    }, a.belowthefold = function(c, f) {
        var g;
        return g = f.container === d || f.container === b ? (b.innerHeight ? b.innerHeight : e.height()) + e.scrollTop() : a(f.container).offset().top + a(f.container).height(), g <= a(c).offset().top - f.threshold
    }, a.rightoffold = function(c, f) {
        var g;
        return g = f.container === d || f.container === b ? e.width() + e.scrollLeft() : a(f.container).offset().left + a(f.container).width(), g <= a(c).offset().left - f.threshold
    }, a.abovethetop = function(c, f) {
        var g;
        return g = f.container === d || f.container === b ? e.scrollTop() : a(f.container).offset().top, g >= a(c).offset().top + f.threshold + a(c).height()
    }, a.leftofbegin = function(c, f) {
        var g;
        return g = f.container === d || f.container === b ? e.scrollLeft() : a(f.container).offset().left, g >= a(c).offset().left + f.threshold + a(c).width()
    }, a.inviewport = function(b, c) {
        return!(a.rightoffold(b, c) || a.leftofbegin(b, c) || a.belowthefold(b, c) || a.abovethetop(b, c))
    }, a.extend(a.expr[":"], {"below-the-fold": function(b) {
            return a.belowthefold(b, {threshold: 0})
        }, "above-the-top": function(b) {
            return!a.belowthefold(b, {threshold: 0})
        }, "right-of-screen": function(b) {
            return a.rightoffold(b, {threshold: 0})
        }, "left-of-screen": function(b) {
            return!a.rightoffold(b, {threshold: 0})
        }, "in-viewport": function(b) {
            return a.inviewport(b, {threshold: 0})
        }, "above-the-fold": function(b) {
            return!a.belowthefold(b, {threshold: 0})
        }, "right-of-fold": function(b) {
            return a.rightoffold(b, {threshold: 0})
        }, "left-of-fold": function(b) {
            return!a.rightoffold(b, {threshold: 0})
        }})
}(jQuery, window, document), function(a, b) {
    function c() {
    }
    function d() {
    }
    function e() {
    }
    a.VIP = a.VIP || {};
    {
        var f = VIP.util = {}, g = VIP.tmpl = {};
        VIP.page = ""
    }
    $.extend(f, {navFix: function(b, c) {
            function d() {
                i = $(this).scrollTop(), i > g ? f() : e()
            }
            function e() {
                c.hide(), j.removeClass("e-nav-fix")
            }
            function f() {
                c.show(), j.addClass("e-nav-fix")
            }
            {
                var g, h, i, j = $(b), c = $(c ? c : ".nav_placeholder");
                $(a).scrollTop()
            }
            return j.length ? (g = j.offset().top, h = j.outerHeight(), c.css({height: h}), $(window).on("scroll resize", function() {
                d()
            }), d(), void j.on("touchmove", function(a) {
                a.preventDefault()
            })) : !1
        }, backToTopFix: function(a) {
            function b() {
                d = c(), $(this).scrollTop() > d ? e.addClass("e-backtop-fixed") : e.removeClass("e-backtop-fixed")
            }
            function c() {
                return 2 * $(window).height()
            }
            var d, e = $(".u-backtop"), a = a || {}, f = a.right, g = a.bottom;
            return e.length ? (e.off("click.u-backtop").on("click.u-backtop", function(a) {
                a.preventDefault(), window.scrollTo(0, 0)
            }), $(window).on("scroll resize", function() {
                b()
            }), f && g && e.css({right: f, bottom: g}), void b()) : !1
        }, backToPreFix: function() {
            var a = $(".J_backToPrev");
            return a.length ? void a.off("click.u-backpre").on("click.u-backpre", function(a) {
                a.preventDefault(), window.history.go(-1)
            }) : !1
        }, pullLoadMore: function(a, b) {
            function c() {
                var c = $(window).height(), d = $(window).scrollTop(), e = $("body").height();
                c + d + b + 60 >= e && (Mar.Seed.request("link", "click", "more-information_btn"), $(window).off("scroll.pullLoadMore resize.pullLoadMore"), a())
            }
            var b = b || 0;
            $(window).on("scroll.pullLoadMore resize.pullLoadMore", function() {
                c()
            }), c()
        }, downloadApp: {init: function() {
                window.downloadAppConfig && (this.cfg = window.downloadAppConfig, this.btnLink = $("." + this.cfg.cls), this.btnClose = $("span", this.btnLink), this.bindEvents())
            }, bindEvents: function() {
                var a = this;
                this.btnClose.click(function(b) {
                    var c = h.Get("WAP[clientClose2]") || 0;
                    b.stopPropagation(), a.btnLink.fadeOut(), h.Del("WAP[clientClose]"), h.Set("WAP[clientClose2]", Number(c) + 1, "", "", "/"), Mar.Seed.request("link", "click", a.cfg.page + "_top_client_close_btn"), $("#brand-search-alphabet").css("top", 51), $(".J_backToPrev").length && $(".J_backToPrev").animate({top: 10}, 600)
                }), this.btnLink.click(function() {
                    location.href = a.cfg.url, Mar.Seed.request("link", "click", a.cfg.page + "_top_client_download_btn"), (new Image).src = "http://mstats.vip.com/v1/counts/m_top_download?id=" + f.getBrowser()
                })
            }}, getUserType: function() {
            var a;
            return window.userType && (a = window.userType.slice(0, 1).toLowerCase()), a
        }, initScrollAd: function(a) {
            var a, b, c;
            b = {startSlide: 0, auto: 5e3}, a = $.extend(b, a), c = $(a.el || ".J_operation_slider"), c.each(function() {
                function c(a) {
                    f && clearInterval(f), f = setTimeout(function() {
                        d.next()
                    }, a)
                }
                var d, e, f, g = $(".J_content_item", this), h = $(".J_btn_item", this), i = $(".J_content_link", this), j = $(".J_content_img", this), k = $(".J_content", this), l = $(this), m = b.startSlide;
                g.length && (j.show(), e = $.map(i, function(a) {
                    return $(a).data("showtime")
                }), d = new Swipe(k[0], {startSlide: m, callback: function(b, d) {
                        var f = e[d] || a.auto;
                        c(f), h.eq(d).addClass("on").siblings().removeClass("on")
                    }}), c(e[m] || a.auto), h.eq(m).addClass("on").siblings().removeClass("on"), $.ajax({url: "ajaxapi-queryAdList.html", data: {s: +new Date, f: l.data("f"), zoneId: l.data("zoneid")}, dataType: "json", success: function(a) {
                        var b = a.data;
                        b && b.length && $(".J_content_link", g).each(function(a) {
                            var c = b[a].url;
                            c && $(this).attr("href", c)
                        })
                    }, error: function() {
                    }}))
            }), $(".scroller_lBer").length && $(".scroller_lBer").each(function() {
            })
        }, getBrowser: function() {
            var a = navigator.userAgent;
            if (!a)
                return"Other";
            if (/MQQBrowser/.test(a))
                return"MQQ";
            if (/UC Browser|UCBrowser|UCWEB/.test(a))
                return"UC";
            if (/QQBrowser/.test(a))
                return"QQ";
            if (/\bQQ\b/.test(a))
                return"IMQQ";
            if (/QHBrowser|360(.+)Browser/.test(a))
                return"QH360";
            if (/MicroMessenger/.test(a))
                return"WeChat";
            if (/baidubrowser|FlyFlow/.test(a))
                return"Baidu";
            if (/OPiOS|Oupeng|Opera/.test(a))
                return"Opera";
            if (/LieBao/.test(a))
                return"Liebao";
            if (/Sogou|MetaSr/.test(a))
                return"Sogou";
            if (/Maxthon/.test(a))
                return"Maxthon";
            var b = a.match(/(safari|chrome|android)/i);
            return b ? b[1] : "Other"
        }, getPrice: function(a) {
            return a ? -1 === a.toString().indexOf("data:image/png;base64") ? a : '<img src="' + a + '">' : ""
        }}), $.extend(g, {getBrandList: function(a) {
            var b = "", c = this;
            return $.each(a.data, function(d, e) {
                var f = e;
                b += f.isOperation && f.operationZones ? f.operationZones : 0 == f.brand_id ? c.getBrandTit(f) : c.getBrandItem({data: f, cName: a.cName})
            }), b
        }, getBrandTit: function(a) {
            return'<div class="u-module-tit">' + a.brand_name + " · " + a.detailurl + "</div>"
        }, getBrandItem: function(a) {
            var b = a.data, c = a.cName, d = b.pms_activetips ? '<div class="u-brand-pms">' + b.pms_activetips + "</div>" : "", e = b.banner_image_url ? '<div class="u-brand-mark"><img width="88" src="' + b.banner_image_url + '" ></div>' : "", f = "<span></span>" !== b.agio && b.agio ? '<span class="u-brand-discount">' + b.agio + "</span>" : "", g = "";
            return g += '<div class="u-brand">                <div class="p-relative">                    <a href="' + b.detailurl + '" class="u-brand-pic J_item-list">                        <img src="' + b.index_image2 + '"                         data-original="' + b.index_image2 + '"                        data-onerror="' + b.index_image + '"                         class="' + c + '"                         style="display: block;">                    </a>                    ' + d + "                    " + e + '                </div>                <div class="u-brand-msg e-border-b clearfix">                    <p class="u-brand-name f-left">' + f + b.brand_name + '</p>                    <div class="u-brand-time f-right">剩' + b.leave_time + "</div>                </div>            </div>"
        }, noData: '        <div class="nullicon"> <span class="n_product"></span>            <div class="space10"></div>            <p>抱歉~商品正在急忙赶路中</p>            <p>先去首页逛逛吧</p>            <div class="space10"></div>            <a href="index.html" class="btn btn-mid btn-purple tohome" mars_sead="preferential-shopping_btn">马上逛逛</a>        </div>'}), function() {
        var b = [{ev: "click", selector: ".J_backToPrev", callback: function() {
                    var b = window.location.href;
                    a.history.go(/#top/.test(b) ? -2 : -1)
                }}, {ev: "touchstart", selector: ".J_loadMore", callback: function() {
                    VIP.pager.isDone = !1, VIP.pager.load()
                }}];
        $.each(b, function(a, b) {
            $("body").delegate(b.selector, b.ev, b.callback)
        });
        var c = [{ev: "loadMore", selector: "", callback: function(a, b) {
                    VIP.pager.load(a, b)
                }}, {ev: "scroll", selector: "", callback: function() {
                    var a = $(this).scrollTop();
                    $(this).trigger("loadMore"), $(this).trigger("processTip", {sTop: a}), $(this).trigger("fixingTitle", {sTop: a})
                }}];
        $.each(c, function(b, c) {
            $(a).delegate(c.selector, c.ev, c.callback)
        })
    }(), VIP.localStorage = {init: function() {
            try {
                window.localStorage.setItem("testLs", 1), window.localStorage.getItem("testLs"), window.localStorage.removeItem("testLs"), VIP.localStorage = localStorage
            } catch (a) {
            }
        }, setItem: $.noop, getItem: $.noop, removeItem: $.noop, clear: $.noop}, VIP.localStorage.init();
    var h = function() {
        var a = {raw: function(a) {
                return a
            }, decoded: function(a) {
                return decodeURIComponent(a.replace(/\+/g, " "))
            }, converted: function(b) {
                0 === b.indexOf('"') && (b = b.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, "\\"));
                try {
                    return a.json ? JSON.parse(b) : b
                } catch (c) {
                }
            }, Set: function(b, c, d, e, f) {
                if (void 0 !== c) {
                    if ("number" == typeof d) {
                        var g = expires = new Date;
                        expires.setTime(g.getTime() + 36e5 * d)
                    }
                    return c = a.json ? JSON.stringify(c) : String(c), document.cookie = [b, "=", a.raws ? c : encodeURIComponent(c), d ? ";expires=" + expires.toUTCString() : "", e ? ";domain=" + e : "", f ? ";path=" + f : ""].join("")
                }
            }, Get: function(b) {
                for (var c = a.raws ? a.raw : a.decoded, d = document.cookie.split("; "), e = b ? void 0 : {}, f = 0, g = d.length; g > f; f++) {
                    var h = d[f].split("="), i = c(h.shift()), j = c(h.join("="));
                    if (i && i === b) {
                        e = a.converted(j);
                        break
                    }
                    b || (e[b] = a.converted(j))
                }
                return e
            }, Del: function(a) {
                var b = new Date;
                b.setTime(b.getTime() - 1e4), document.cookie = a + "=a; expires=" + b.toGMTString()
            }}, b = {versions: function() {
                {
                    var a, b = navigator.userAgent.toLowerCase();
                    navigator.appVersion
                }
                return{trident: b.indexOf("trident") > -1, presto: b.indexOf("presto") > -1, webKit: b.indexOf("applewebkit") > -1, gecko: b.indexOf("gecko") > -1 && -1 == b.indexOf("khtml"), isMobile: !!b.match(/applewebkit.*mobile.*/) || !!b.match(/applewebkit/), isIos: !!b.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), isAndroid: b.indexOf("android") > -1 || b.indexOf("linux") > -1, isIPhone: b.indexOf("iphone") > -1 || b.indexOf("mac") > -1, isIPad: b.indexOf("ipad") > -1, isSafari: (a = b.match(/version\/([\d.]+).*safari/)) ? a[1] : 0, webApp: -1 == b.indexOf("safari")}
            }, language: (navigator.browserLanguage || navigator.language).toLowerCase(), devicesInfo: function() {
                var a = document.body, b = window;
                return{cWidth: a.clientWidth, cHeight: a.clientHeight, sWidth: b.screen.width, sHeight: b.screen.height, offWidth: a.offsetWidth, offHeight: a.offsetHeight, acWidth: b.screen.availWidth, acHeight: b.screen.availHeight, wWidth: b.innerWidth, wHeight: b.innerHeight, wOri: b.orientation}
            }};
        return{Get: a.Get, Set: a.Set, Del: a.Del, Browser: b.versions}
    }();
    a.Cookie = h, VIP.scroller = function() {
        var b = $(a).scrollTop();
        return{getScrollTop: function() {
                return b
            }, setScrollTop: function(a) {
                b = a
            }}
    }(), $.extend(c.prototype, {page: {offset: 0, limit: 10}, originalOffset: 10, txtNoMoreData: '<div class="u-more-btn u-loading">亲，没有更多了</div>', txtGetMoreData: '<div class="u-more-btn u-loading">查看更多在售品牌..</div>', txtLoading: '<div class="u-more-btn u-loading"><img src="view/touch/images/common/loading-big.gif" alt="loading" />100%正品保证</div>', threshold: 1e3, more: $(".J_pager_more"), config: function(a) {
            $.extend(this, a), this.originalOffset = this.el.data("offset"), this.page.offset = this.getOffset(), this.imageClassName = this.el.data("img-class"), this.isInitialized = !0, this.sendMars(), this.init()
        }, getOffset: function() {
            var a, b, c = this.page.limit, d = this.originalOffset;
            return d >= c ? (b = d % c, a = d - b) : a = 0, a
        }, sendMars: function() {
            return this.mars ? void Mar.Seed.request("link", "click", this.mars, this.page.offset) : !1
        }, load: function() {
            return!this.isInitialized || this.isLoading || this.isDone || !this.isInView() ? !1 : (this._beforePage(), void this.getData())
        }, isInView: function() {
            var b = this.more;
            return b.length ? b.offset().top - $(a).scrollTop() - $(a).height() < this.threshold ? !0 : void 0 : !1
        }, getData: function() {
            var a;
            a = $.extend(this.reqData, this.page), $.ajax({url: this.url, data: this.reqData, dataType: "json", success: $.proxy(this.handleSuccess, this), error: $.proxy(this.handleError, this)})
        }, sliceData: function(a) {
            var b = this.page.offset, c = this.originalOffset;
            return c > b && (a = a.slice(c - b)), a
        }, formatData: function(a) {
            return a
        }, handleSuccess: function(a) {
            var b;
            a && a.result ? (b = a.data, b && b.length ? (b = this.formatData(this.sliceData(b)), this.render(b, a)) : this.isDone = !0) : this.handleError(), this._afterPage()
        }, handleError: function() {
            this.error(), this.isLoading = !1
        }, error: function() {
            this.more.html("网络延时，请重试")
        }, beforePage: function() {
            this.more.html(this.txtLoading)
        }, afterPage: function() {
            this.isDone ? this.more.html(this.txtNoMoreData) : ($("." + this.imageClassName).slice(this.page.offset).lazyload({effect: "fadeIn", effect_speed: 100, threshold: 1e3}), this.more.html(this.txtGetMoreData))
        }, _beforePage: function() {
            this.beforePage(), this.isLoading = !0
        }, _afterPage: function() {
            this.afterPage(), this.isLoading = !1, this.setPage({offset: this.page.offset + this.page.limit}), this.sendMars()
        }, setPage: function(a) {
            $.extend(this.page, a)
        }, render: $.noop, init: $.noop, isLoading: !1, isDone: !1, isInitialized: !1}), VIP.pager = new c, $.extend(d.prototype, {titleSelector: ".J_title_fixer_title", contentSelector: ".J_title_fixer_content", fixedTitleSelector: ".J_title_fixer_fixed_title", config: function(b) {
            $.extend(this, b), this.titleList = $(this.titleSelector, this.el), this.contentList = $(this.contentSelector, this.el), this.fixedTitle = $(this.fixedTitleSelector, this.el), this.bindEvent(), $(a).trigger("fixingTitle", {sTop: $(a).scrollTop()})
        }, scroller: a, addTitle: function(a) {
            this.titleList.push(a)
        }, addContent: function(a) {
            this.contentList.push(a)
        }, bindEvent: function() {
            var b = this, c = this.scroller;
            c === a ? $(a).on("fixingTitle", $.proxy(this.handleScroll, this)) : c.on("scroll", function(a) {
                b.handleScroll(a, {sTop: c.scrollTop()})
            })
        }, showTitle: function(a) {
            this.fixedTitle.html(a).show()
        }, hideTitle: function() {
            this.fixedTitle.hide()
        }, handleScroll: function(a, b) {
            var c = this.getMatchedContent(b), d = c.k, e = $(c.v), f = $(this.titleList[d]);
            return f ? void(e.length ? e != this.curContent && (this.curContent = e, this.showTitle(f.html(), f)) : this.hideTitle()) : !1
        }, getMatchedContent: function(a) {
            var b, c, d = this.contentList, e = a.sTop;
            return d.each(function(a) {
                var d = $(this), f = d.offset().top, g = d.height();
                return e >= f && f + g > e ? (b = d, c = a, !1) : void 0
            }), {k: c, v: b}
        }, init: $.noop}), VIP.TitleFixer = d, $.extend(e.prototype, {itemSelector: ".J_process_tip_item", tipHTML: '            <div class="scroll_tips_right">              <span class="i_clock"></span>              <div class="scroll_info">                <p class="J_title"></p>                <p><span class="J_cur"></span> / <span class="J_total"></span></p>              </div>            </div>        ', el: $(b.body), scroller: a, init: function(b) {
            $.extend(this, b), this.beforeInit(), this.tip = $(this.tipHTML), this.el.append(this.tip), this.bindEvent(), $(a).trigger("processTip", {sTop: $(a).scrollTop()})
        }, bindEvent: function() {
            $(a).on("processTip", $.proxy(this.handleScroll, this))
        }, showTip: function() {
            var a = this;
            this.tip.show(), this.interval && clearInterval(this.interval), this.interval = setTimeout(function() {
                a.tip.hide()
            }, 2e3)
        }, hideTip: function() {
            this.tip.hide()
        }, beforeInit: function() {
            this.data = [{title: "今日新品", count: this.el.data("tcount")}, {title: "昨日上线", count: this.el.data("ycount")}, {title: "最后疯抢", count: this.el.data("lcount")}]
        }, setTip: function(a, b) {
            for (var c, d, e, f = 0, g = 0; g < this.data.length; g++)
                if (f += this.data[g].count, f > b) {
                    c = this.data[g];
                    break
                }
            c && (d = c.title, e = b - (f - c.count) + 1, f = c.count), this.tip.find(".J_title").text(d), this.tip.find(".J_cur").text(e), this.tip.find(".J_total").text(f)
        }, isInView: function(a) {
            var b = this.el, c = b.offset().top, d = b.height();
            return a >= c - 200 && c + d - 200 > a ? !0 : !1
        }, handleScroll: function(a, b) {
            var c, d = $(this.itemSelector, this.el), e = b.sTop, f = this.isInView(e);
            f ? (d.each(function(a) {
                var b = $(this), d = b.offset().top, f = b.height();
                return e >= d - 200 && d + f - 200 > e ? (c = b, key = a, !1) : void 0
            }), c && (this.showTip(), this.setTip(c, key))) : this.hideTip()
        }, getMatchedContent: function(a) {
            var b, c, d = this.contentList, e = a.sTop;
            return d.each(function(a) {
                var d = $(this), f = d.offset().top, g = d.height();
                return e >= f && f + g > e ? (b = d, c = a, !1) : void 0
            }), {k: c, v: b}
        }}), VIP.ProcessTip = e
}(window, document);
var VsmwebForm = function() {
    var a = $('[data-getvercode="code"]'), b = $("[data-bindmethod]"), c = $('[data-bindpsw="password"]'), d = $("[data-fbmethod]"), e = $('[data-mersale="true"]'), f = $('[data-beautycart="true"]'), g = $('[data-OrderFailFrom="true"]'), h = $('[data-cartforms="address"]'), i = $('[data-cartforms="time"]'), j = $('[data-cartforms="payway"]'), k = $('[data-cartforms="invoice"]'), l = $(".input_empty_text"), m = $('[data-twicecart="payway"]'), n = $('[data-twicecart="wallet"]'), p = $('[data-tabsel="tab"]'), q = $(".use-bonus"), r = $("[data-favorable]"), s = $('input[data-check="checkall"]'), t = $("[data-addbonus]"), u = $('[data-orderreturn="list"]'), v = $('[data-orderreturn="reason"]'), w = $('[data-orderreturn="way"]'), x = $('[data-submitreturn="order"]'), y = $('[data-commit="address"]'), z = $('[data-address="del"]'), A = $('[data-selcoupon="true"]'), B = $('[data-catetype="cart"]'), C = $('[data-carttype="bank"]'), D = $('[data-addaddress="true"]'), E = {e: /^[a-zA-Z0-9]+[a-zA-Z0-9_.-]+[a-zA-Z0-9_-]+@[a-zA-Z0-9]+[a-zA-Z0-9.-]+[a-zA-Z0-9]+.[a-z]{2,4}$/, m: /^(1[3458][0-9]|17[0678])\d{8}$/, s: /^[A-Za-z]{6,20}$/, c: /^[\u4e00-\u9fa5]{1,8}$/}, F = {black: function(a, b, c) {
            VsmCart.VsmDialog(a, {width: "auto", title: "" != b ? b : "友情提示", overClose: !1, closeBtn: !1, setClass: "ui-modal-black", buttons: !1, overShow: !1, autoClose: c ? c : 3e3})
        }}, G = {tiggerLoginBaddCartinit: function() {
            var a = $('[data-loginaddcart="true"]'), b = {elem: a, shopcart: $('[data-shopcart="true"]'), jump: a.data("addjump"), anItem: a.data("animate"), size: a.data("sid"), num: 1, product_id: a.data("pid"), channel_id: a.data("chid"), cat_id: parseInt(a.data("catid")), warehouse: a.data("wh"), product_name: a.data("pname"), small_image: a.data("simg"), vipshop_price: parseInt(a.data("vpic")), market_price: parseInt(a.data("mpic")), agio: a.data("agio"), back_url: encodeURIComponent(location.href)};
            G.tiggerBeautyaddCartDo(b)
        }, addCartByData: function() {
            var a = window.addCardProduct;
            return a ? (a = {elem: $("<div>"), shopcart: $('[data-shopcart="true"]'), jump: 1, anItem: !0, size: a.skuId, num: 1, product_id: a.product_id, channel_id: a.channel_id, cat_id: a.cat_id, warehouse: window.warehouse, product_name: a.product_name, small_image: a.small_image, small_image2: a.small_image2, vipshop_price: a.vipshop_price, market_price: a.market_price, agio: a.agio, back_url: encodeURIComponent(location.href)}, void G.tiggerBeautyaddCartDo(a)) : !1
        }, tiggerBeautyaddCartinit: function() {
            var a = $(this), b = {elem: a, shopcart: $('[data-shopcart="true"]'), jump: a.data("addjump"), anItem: a.data("animate"), size: a.data("sid"), num: 1, product_id: a.data("pid"), channel_id: a.data("chid"), cat_id: parseInt(a.data("catid")), warehouse: a.data("wh"), product_name: a.data("pname"), small_image: a.data("simg"), vipshop_price: parseInt(a.data("vpic")), market_price: parseInt(a.data("mpic")), agio: a.data("agio"), back_url: encodeURIComponent(location.href)};
            G.tiggerBeautyaddCartDo(b)
        }, tiggerBeautyaddCartDo: function(a) {
            var b = I.tiggerIsEmpty(a.size), c = I.tiggerIsEmpty(a.product_id), d = I.tiggerIsEmpty(a.num);
            if (!c)
                return F.black("无法加入购物车：未知异常"), !1;
            if (!b)
                return F.black("无法加入购物车：未知异常"), !1;
            if (!d || a.num > 1 || a.num <= 0)
                return F.black("无法加入购物车：请勿修改数量"), !1;
            if (1 == a.jump) {
                $("<div />", {"class": "lmask"}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;" />').appendTo(a.elem.parent());
                var e = {url: "index.php?", data: {m: "flow", act: "addtocart", channel_id: a.channel_id, product_id: a.product_id, size: a.size, num: a.num, cat_id: a.cat_id, warehouse: a.warehouse, product_name: a.product_name, small_image: a.small_image, agio: a.agio, back_url: a.back_url}, dataType: "json", type: "GET"};
                e.error = function() {
                    a.elem.next().remove(), F.black("网络延时，请刷新页面重试")
                }, e.success = function(b) {
                    if (a.elem.next().remove(), 0 == b.code && b.add_num > 0) {
                        var c = {elem: a.shopcart.children().find(".u-flow-carttime"), time: b.clear_time, timeUnitCls: {day: "", hour: "", min: ":", sec: ""}, showMin: !0, action: "remain", onEndCallBack: !0, onEndComplete: function() {
                                this.parent().parent().fadeOut(function() {
                                    $(this).children().html("")
                                })
                            }}, d = {elem: a.shopcart, imgobj: a.elem.parent().prev().children().find("img"), imgUrl: a.small_image2, mode: 2};
                        a.shopcart.children().find(".u-flow-cartnum").html(b.count).fadeIn().next().fadeIn(), VsmCart.countclose(), VsmCart.countdown(c), a.anItem && G.addAnimate(d), $("#om_act_url").attr("src", b.om_act_url)
                    } else if (111 == b.code && b.url.length > 1)
                        location.href = b.url;
                    else if (b.code > 0 && b.msg.length > 1)
                        return F.black(b.msg), !1
                }, $.ajax(e)
            }
        }, getScroll: function() {
            return self.pageYOffset ? {scrollTop: self.pageYOffset, scrollLeft: self.pageXOffset} : document.documentElement && document.documentElement.scrollTop ? {scrollTop: document.documentElement.scrollTop, scrollLeft: document.documentElement.scrollLeft} : document.body ? {scrollTop: document.body.scrollTop, scrollLeft: document.body.scrollLeft} : void 0
        }, addAnimatedraw: function(a) {
            var b = G.getScroll();
            a.addBox.css({left: (a.winW - a.addBox.width()) / 2, top: (a.winH - a.addBox.height()) / 2}).show().animate({width: a.endWidth, top: a.endOffset.top - b.scrollTop - a.endHeight / 5, left: a.endOffset.left - 2}, 1e3, function() {
                $(this).fadeOut(function() {
                    $(this).remove()
                })
            })
        }, addAnimate: function(a) {
            if (1 == a.mode)
                var b = a.elem.prev().children(".carticon"), c = $("<img />", {src: "" + $('[data-cartimg="img"]').children("li:eq(0)").find("img").attr("src")});
            else if (2 == a.mode) {
                a.elem.is(":hidden") ? a.elem.fadeIn("fast") : "";
                var b = a.elem.children().find(".i-flow-carticon"), c = $("<img />", {src: "" + (a.imgobj.data("original") || a.imgUrl)})
            }
            var d = {endOffset: b.offset(), endWidth: b.outerWidth(), endHeight: b.outerHeight(), winW: $(window).width(), winH: $(window).height(), addBox: $("<div />", {"class": "ui-model-animation hide"})};
            c.appendTo(d.addBox), d.addBox.appendTo(document.body), G.addAnimatedraw(d)
        }}, H = {sizeDefault: function() {
            var a = saveProValue(), b = {product_id: parseInt(a.product_id), brand_id: parseInt(a.brand_id), userUrl: "ajaxapi-productsizes.html?"};
            return{wapDom: b}
        }, tiggerMerSize: function() {
            var a = $(this), b = {elem: a, clsName: a.attr("class"), size: parseInt(a.data("size"), 10), input: a.parent().next().filter('input[name="size"]'), pars: a.parent(), parent: a.parent().parent(), index: a.parent().children().index(this), top: a.position().top + parseInt(a.css("marginTop")) - 60, left: a.position().left + (a.innerWidth() / 2 - 15), getsize: a.parent().data("mersale")};
            "choose" == b.clsName && b.elem.addClass("select").siblings("li").filter(".choose").removeClass("select").parent().next().filter('input[name="size"]').val(b.size), b.getsize && (void 0 == b.pars.data("saveData") ? H.GetProSize(b) : H.SaveProSize(b.pars.data("saveData"), b))
        }, GetProSize: function(a) {
            var b = H.sizeDefault();
            $.ajax({url: b.wapDom.userUrl + "s=" + (new Date).getTime(), data: {act: b.wapDom.act, productid: b.wapDom.product_id, brandid: b.wapDom.brand_id}, dataType: "json", success: function(b) {
                    H.SaveProSize(b, a), a.pars.data("saveData", b)
                }})
        }, SaveProSize: function(a, b) {
            $.each(a, function(c) {
                var d = a[c], e = b.parent;
                if (d.content.length > 0 && "array" == d.type) {
                    e.find(".J_wrap_tableBox").html() && e.find(".J_wrap_tableBox").remove();
                    var f = Math.ceil(99999 * Math.random());
                    e.append('<div class="J_wrap_tableBox" id="J_wrap_table' + f + '"></div>'), $("#J_wrap_table" + f).css({opacity: 0}).prepend('<div class="J_wrap_tableInfo"><a class="J_close">x</a><div class="J_arrow"></div><table class="J_wrap_sizeTable hidden" border="0" cellspacing="0" cellpadding="0" width="100%" bordercolor="#CCCACC" id="J_wrap_sizeTemplate"><tbody id="J_tableBody"></tbody></table></div>'), $("#J_wrap_table" + f).children().find("table").removeClass("hidden"), $_tableHtml = "", $_tableHtml += "<tr>", $.each(d.content[0], function(a, b) {
                        $_tableHtml += "" == b ? "<th>/</th>" : "<th>" + b + "</th>"
                    }), $_tableHtml += "</tr>", $_tableHtml += "<tr>", $.each(d.content[b.index + 1], function(a, b) {
                        $_tableHtml += "" == b ? "<td>/</td>" : "<td>" + b + "</td>"
                    }), $_tableHtml += "</tr>", $("#J_wrap_table" + f).children().find("table").children("#J_tableBody").prepend($_tableHtml), $("#J_wrap_table" + f).children().children(".J_arrow").css({left: b.left}), $("#J_wrap_table" + f).css({top: b.top}).fadeTo(500, .85)
                }
            }), $(".J_close").on("click.closeJprosize", function() {
                $(this).parents(".J_wrap_tableBox").dequeue().fadeOut("fast", function() {
                    $(this).remove()
                })
            })
        }}, I = {tiggerIsEmpty: function(a) {
            return"" == $.trim(a) ? 0 : 1
        }, validateEmpty: function(a) {
            var b = I.tiggerIsEmpty(a) ? a : "", c = arguments[1] ? arguments[1] : "";
            return"" == b ? (VsmCart.VsmDialog(c + "不能为空", {position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%"}), !1) : void 0
        }, validateMobile: function(a) {
            var b = I.tiggerIsEmpty(a) ? a : "", c = arguments[1] ? arguments[1] : "";
            return check = arguments[2] ? arguments[2] : !1, check && "boolean" == typeof check ? void(b.length > 0 ? a.next().next().attr("disabled", !1).removeClass("btn_gry").addClass("btn_red") : a.next().next().attr("disabled", !0).removeClass("btn_red").addClass("btn_gry")) : E.m.test(b) ? !0 : "" == b ? (F.black(c + "不能为空"), !1) : (F.black(c + "格式错误"), !1)
        }, validatePsw: function(a) {
            var b = I.tiggerIsEmpty(a.psw1.val()) ? a.psw1.val() : "";
            if (a.psw2 && a.psw2.length) {
                var c = I.tiggerIsEmpty(a.psw2.val()) ? a.psw2.val() : "";
                return"" == b ? (F.black(a.txt + "不能为空"), a.psw1.focus(), !1) : b.length < 6 || b.length > 20 ? (F.black(a.txt + "长度错误，请输入6-20位字母和数字的组合！"), a.psw1.focus(), !1) : isNaN(b) && "-1" == b.search(E.s) ? c != b ? (F.black("两次输入密码不一样！"), a.psw2.focus(), !1) : !0 : (F.black(a.txt + "格式错误，请使用字母和数字组合！"), a.psw1.focus(), !1)
            }
            return"" == b ? (F.black(a.txt + "不能为空"), a.psw1.focus(), !1) : b.length < 6 || b.length > 20 ? (F.black(a.txt + "长度错误，请输入6-20位字母和数字的组合！"), a.psw1.focus(), !1) : isNaN(b) && "-1" == b.search(E.s) ? !0 : (F.black(a.txt + "格式错误，请使用字母和数字组合"), a.psw1.focus(), !1)
        }}, J = {tiggerpswCheckinit: function(a) {
            var b = (a.elem, {psw1: $('input[name="pswfirst"]'), psw2: $('input[name="pswend"]'), txt: "密码"}), c = I.validatePsw(b);
            c && $.ajax({url: "user-wallet-bind-set.html?", data: {ajax: 1, password: rstr2b64($.trim(b.psw2.val()))}, dataType: "json", success: function(a) {
                    a && null != a && void 0 != a ? 0 == a.code ? a.data.url && "" != a.data.url && (location.href = a.data.url) : 1 == a.code ? F.black(a.msg) : a.code > 0 && F.black(a.msg) : F.black("网络超时，请刷新重试")
                }, error: function() {
                    F.black("网络超时，请刷新重试")
                }})
        }, tiggerverCheckinit: function() {
            var a = $(this), b = VmPageEffect.localUrl(location.href), c = {elem: a, pars: a.parent(), Method: a.attr("data-bindmethod"), input: a.parent().children().filter('input[name="check_code"]').val(), mobileobj: a.parent().children().filter('input[name="phone"]'), mobileval: a.parent().children().filter('input[name="phone"]').val(), mobilei: parseInt(a.parent().children().filter('[data-getvercode="code"]').data("setmobile"), 10), codeType: b.params.ref && "checkout" === b.params.ref ? 4 : isNaN(a.parent().children('button[type="button"]').data("code")) ? "" : a.parent().children('button[type="button"]').data("code")};
            if (c.mobileobj.length && void 0 != c.mobileobj)
                var d = I.tiggerIsEmpty(c.input, "验证码"), e = I.validateMobile(c.mobileval, "手机号码");
            else
                var d = I.tiggerIsEmpty(c.input, "验证码"), e = I.validateMobile(c.mobilei, "手机号码");
            d && e && J.tiggerverCheck(c)
        }, tiggerverCheck: function(a) {
            $.ajax({url: "user-wallet-bind-check.html?" + (new Date).getTime(), data: {check_code: rstr2b64($.trim(a.input)), phone: rstr2b64(a.mobileobj.length ? $.trim(a.mobileval) : $.trim(a.mobilei)), codeType: a.codeType}, dataType: "json", success: function(b) {
                    b && null != b && void 0 != b ? 0 == b.code ? "string" == typeof a.Method && ("wallet" == a.Method ? location.href = "user-wallet-bind-set.html" : "next" == a.Method && a.pars.fadeOut("fast", function() {
                        $(this).next()[0].codeType = a.codeType;
                        var b = $(this).next(), c = {elem: b, sMethod: b.children('input[type="button"]').data("savamethod"), event1: b.children('input[name="password"]'), event2: b.children('input[name="pswend"]')};
                        $(this).next().show(), "string" == typeof c.sMethod && ("changemobile" == c.sMethod ? (P.inputOpera.call(c.event1, 1), c.elem.delegate('[data-savamethod="changemobile"]', "click.method.changemobile", J.tiggerChangeMobile), $("<input />", {type: "hidden", name: "oldphone", value: a.mobilei}).appendTo(c.elem)) : "changepsw" == c.sMethod && (P.inputOpera.call(c.event2, 1), c.elem.delegate('[data-savamethod="changepsw"]', "click.method.changepsw", J.tiggerChangePsw)))
                    })) : F.black(1 == b.code ? b.msg : b.msg) : F.black("网络超时，请刷新重试")
                }, error: function() {
                    F.black("网络超时，请刷新重试")
                }})
        }, tiggerChangeMobile: function() {
            var a = $(this), b = {elem: a, mobile: a.parent().children().filter("input[name=phone]").val(), psw1: a.parent().children().filter("input[name=password]"), txt: "密码", oldPhone: a.next('input[name="oldphone"]').val()}, c = I.validateMobile(b.mobile, "手机号码"), d = I.validatePsw(b);
            if (c && d) {
                var e = {url: "user-wallet-bind-update.html?", data: {ajax: 1, old_phone: rstr2b64($.trim(b.oldPhone)), new_phone: rstr2b64($.trim(b.mobile)), password: rstr2b64($.trim(b.psw1.val())), codeType: a.parent()[0].codeType}, dataType: "json", type: "GET"};
                J.tiggerCMethod(e)
            }
        }, tiggerChangePsw: function() {
            var a = $(this), b = {elem: a, mobile: a.parent().children().filter("input[name=phone]").val(), psw1: a.parent().children().filter('input[name="pswfirst"]'), psw2: a.parent().children().filter('input[name="pswend"]'), txt: "密码"}, c = I.validateMobile(b.mobile, "手机号码"), d = I.validatePsw(b);
            if (c && d) {
                var e = {url: "user-wallet-reset-index.html?", data: {ajax: 1, phone: rstr2b64($.trim(b.mobile)), password: rstr2b64($.trim(b.psw2.val())), codeType: a.parent()[0].codeType}, dataType: "json", type: "GET"};
                J.tiggerCMethod(e)
            }
        }, tiggerCMethod: function(a) {
            a.error = function() {
                F.black("网络超时，请刷新重试")
            }, a.success = function(a) {
                a && null != a && void 0 != a ? 0 == a.code ? a.data.url && "" != a.data.url && (location.href = a.data.url) : F.black(1 == a.code ? a.msg : a.msg) : F.black("网络超时，请刷新重试")
            }, $.ajax(a)
        }, tiggergetCodeinit: function() {
            var a = $(this), b = VmPageEffect.localUrl(location.href), c = {elem: a, mobileobj: a.prev().filter('input[name="phone"]'), mobileval: a.prev().filter('input[name="phone"]').val(), mobilei: parseInt(a.data("setmobile"), 10), codeType: b.params.ref && "checkout" === b.params.ref ? 4 : isNaN(a.data("code")) ? "" : a.data("code"), time: 60, showMsg: "倒计时", timeUnitCls: {day: "", hour: "", min: "", sec: "秒"}, showMin: !1, action: "remain", onEndCallBack: !0, onEndComplete: function() {
                    this.html("获取验证码").attr("disabled", !1)
                }};
            if (c.mobileobj.length && void 0 != c.mobileobj) {
                var d = I.validateMobile(c.mobileval, "手机号码");
                d && J.tiggerGetCode(c)
            } else {
                var d = I.validateMobile(c.mobilei, "手机号码");
                d && J.tiggerGetCode(c)
            }
        }, tiggerGetCode: function(a) {
            $.ajax({url: "user-wallet-bind-send.html?", data: {ajax: 1, phone: rstr2b64(a.mobileobj.length ? $.trim(a.mobileval) : $.trim(a.mobilei)), codeType: a.codeType}, type: "GET", dataType: "json", success: function(b) {
                    b && null != b && void 0 != b ? 0 == b.code ? (a.elem.attr("disabled", !0), VsmCart.countdown(a), F.black(b.msg)) : F.black(1 == b.code ? b.msg : b.msg) : F.black("网络超时，请刷新重试")
                }, error: function() {
                    F.black("网络超时，请刷新重试")
                }})
        }, tiggerFBSendinit: function() {
            if ("send" === $(this).attr("data-fbmethod")) {
                var a = $(this), b = a.parents('[data-setforms="true"]'), c = {elem: a, elemTxt: a.val(), reason: b.find('textarea[name="reason"]').val(), order: b.find('input[name="order_sn"]').val(), orderstate: b.find('input[name="order_state"]').val()};
                if (!I.tiggerIsEmpty(c.order))
                    return F.black("无法提交：未知异常"), !1;
                if (!I.tiggerIsEmpty(c.reason))
                    return F.black("配送留言不能为空"), VmPageEffect.sharkError(c.reason.parent(), "ui-note-error", !1, 0, 5, 50), !1;
                var d = {url: "acs-ccps.html?", data: {"do": "extform", reason: c.reason, order_sn: c.order, order_state: c.orderstate}, dataType: "json", type: "POST"};
                J.tiggerFBSend(c, d)
            } else if ("return" === $(this).attr("data-fbmethod")) {
                var a = $(this), b = a.parents('[data-setforms="true"]'), c = {elem: a, elemTxt: a.val(), company: b.find('input[name="wl_company"]').val(), ordersn: b.find('input[name="wl_ordersn"]').val(), reason: b.find('textarea[name="reason"]').val(), order: b.find('input[name="order_sn"]').val(), orderstate: b.find('input[name="order_state"]').val()};
                if (!I.tiggerIsEmpty(c.order))
                    return F.black("无法提交：未知异常"), !1;
                if (!I.tiggerIsEmpty(c.company))
                    return F.black("回寄物流公司不能为空"), VmPageEffect.sharkError(b.find('input[name="wl_company"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (!I.tiggerIsEmpty(c.ordersn))
                    return F.black("回寄运单单号不能为空"), VmPageEffect.sharkError(b.find('input[name="wl_ordersn"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (!I.tiggerIsEmpty(c.reason))
                    return F.black("退款原因不能为空"), VmPageEffect.sharkError(b.find('textarea[name="reason"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                var d = {url: "acs-cctk.html?", data: {"do": "extform", wl_company: c.company, wl_ordersn: c.ordersn, reason: c.reason, order_sn: c.order, order_state: c.orderstate}, dataType: "json", type: "POST"};
                J.tiggerFBSend(c, d)
            } else if ("set" === $(this).attr("data-fbmethod")) {
                var a = $(this), b = a.parents('[data-setforms="true"]'), c = {elem: a, elemTxt: a.val(), fpheader: b.find('input[name="fpheader"]').val(), consignee: b.find('input[name="consignee"]').val(), mobile: b.find('input[name="mobile"]').val(), province: b.find('select[name="province"] option:selected').val(), city: b.find('select[name="city"] option:selected').val(), district: b.find('select[name="district"] option:selected').val(), street: b.find('select[name="street"] option:selected').val(), address: b.find('textarea[name="address"]').val(), order: b.find('input[name="order_sn"]').val(), orderstate: b.find('input[name="order_state"]').val()};
                if (!I.tiggerIsEmpty(c.order))
                    return F.black("无法提交：未知异常"), !1;
                if (!I.tiggerIsEmpty(c.fpheader))
                    return F.black("发票抬头不能为空"), VmPageEffect.sharkError(b.find('input[name="fpheader"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (!I.tiggerIsEmpty(c.consignee))
                    return F.black("收货人不能为空"), VmPageEffect.sharkError(b.find('input[name="consignee"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (!I.tiggerIsEmpty(c.mobile))
                    return F.black("手机号码不能为空"), VmPageEffect.sharkError(b.find('input[name="mobile"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (I.tiggerIsEmpty(c.mobile) && !E.m.test(c.mobile))
                    return F.black("手机号码格式不正确"), VmPageEffect.sharkError(b.find('input[name="mobile"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (I.tiggerIsEmpty(c.province) && c.province < 1)
                    return F.black("请选择省"), VmPageEffect.sharkError(b.find('select[name="province"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (I.tiggerIsEmpty(c.city) && c.city < 1)
                    return F.black("请选择市"), VmPageEffect.sharkError(b.find('select[name="city"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (I.tiggerIsEmpty(c.district) && c.district < 1)
                    return F.black("请选择区"), VmPageEffect.sharkError(b.find('select[name="district"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                if (!I.tiggerIsEmpty(c.address))
                    return F.black("请填写详细地址"), VmPageEffect.sharkError(b.find('textarea[name="address"]').parent(), "ui-note-error", !1, 0, 5, 50), !1;
                var d = {url: "acs-bjfp.html?", data: {"do": "extform", fpheader: c.fpheader, consignee: c.consignee, mobile: c.mobile, province: c.province, city: c.city, district: c.district, street: c.street, address: c.address, order_sn: c.order, order_state: c.orderstate}, dataType: "json", type: "POST"};
                J.tiggerFBSend(c, d)
            }
        }, tiggerFBSend: function(a, b) {
            a.elem.val(""), $("<div />", {"class": "ui-btn-mask"}).css({height: a.elem.outerHeight()}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;" /> ' + a.elem.attr("data-loading-text")).appendTo(a.elem.parent()), b.success = function(b) {
                a.elem.val(a.elemTxt).next().remove(), b && null != b && void 0 != b ? 1 == b.code ? (VsmCart.VsmDialog(b.msg + "页面正在跳转", {setClass: "ui-success", overShow: !1, overClose: !1, position: [{top: 0}, {left: 0}], width: "100%", autoClose: 3e3}), setTimeout(function() {
                    self.location.href = b.url
                }, 2e3)) : F.black(0 == b.code ? b.msg : "网络延时，提交失败") : F.black("网络延时，提交失败")
            }, b.error = function() {
                a.elem.val(a.elemTxt).next().remove(), F.black("网络延时，提交失败")
            }, $.ajax(b)
        }}, K = {triggerChooseInfo: function() {
            var a = $(this), b = {elem: a, selt: a.children().filter("span.i-radio"), sibs: a.siblings("li"), text: a.children("p").eq(0).html(), address: a.children("p").eq(1).html() ? a.children("p").eq(1).html() : null};
            !b.selt.hasClass("active") && !("checked" == b.selt.next().filter('input[type="radio"]').attr("checked")) && b.selt.addClass("active").parent().children().filter('input[type="radio"]').attr("checked", !0), b.sibs.children().filter("span.i-radio").removeClass("active").parent().children().filter('input[type="radio"]').attr("checked", !1), b.elem.parents("[data-cartforms]").children().first().children().filter(".title").text(b.text).parent().children().filter(".check_addr").text(b.address), VsmwebEffect.accordion(b.address ? $('[data-cartforms="address"]').children(":eq(0)") : $('[data-cartforms="time"]').children("p"))
        }, triggerChoosePayway: function() {
            var a = $(this), b = {elem: a, selt: a.children().filter("span.i-radio"), sibs: a.siblings("li"), child: a.siblings("li").children(".dropdiv"), slide: !1};
            b.selt.addClass("active").next().filter('input[type="radio"]').attr("checked", !0), b.selt.hasClass("active") && (b.sibs.children().filter("span.i-radio").removeClass("active").next().filter('input[type="radio"]').attr("checked", !1), $.each(b.sibs, function() {
                $(this).hasClass("bankpay") && ($(this).children().filter('input[type="radio"]').attr("data-bankid", "").attr("data-type", "").parent().find("li").children("span").removeClass("sz_seleted"), $(this).children("p").html("银行卡(<em>请选择支付卡种</em>)"), K.triggerBankUp.call(b))
            }))
        }, triggerBankList: function() {
            var a = $(this), b = {elem: a, child: a.parent().children(".dropdiv"), scrol: a.parent(), slide: !1};
            b.child.is(":hidden") ? K.triggerBankDown.call(b) : K.triggerBankUp.call(b)
        }, triggerBankDown: function() {
            this.child.slideDown("fast", function() {
                $(this).children('[data-carttype="bank"]').innerHeight()
            }).prev().removeClass("down_arrow").addClass("up_arrow").parent().css({height: "auto"}), $("body,html").animate({scrollTop: this.elem.offset().top}, 200)
        }, triggerBankUp: function() {
            var a = this.scrol;
            this.slide ? this.child.slideUp("fast", function() {
                $("body,html").animate({scrollTop: a.offset().top - 44}, 200)
            }).prev().removeClass("up_arrow").addClass("down_arrow") : this.child.slideUp("fast").prev().removeClass("up_arrow").addClass("down_arrow")
        }, triggerBankMenu: function() {
            var a = $(this), b = {elem: a, index: a.parent().children().index(this), next: a.parent().next().children("ul")};
            b.elem.children("span").hasClass("cur") ? "" : (b.elem.children("span").addClass("cur").parent().siblings().children("span").removeClass("cur"), b.next.filter(":visible").fadeOut("fast", function() {
                b.next.eq(b.index).fadeIn("fast")
            }))
        }, triggerChooseWallet: function() {
            var a = $(this), b = nWalletMoney();
            dom = {elem: a, isBind: parseInt(a.children().filter('input[name="wallet"]').data("isbind")), isEnough: parseInt(a.children().filter('input[name="wallet"]').data("enpay")), money: b.wallet, totleMoney: b.total, wallet: a.children().filter('input[name="wallet"]'), walletPsw: a.children().filter('input[name="wallet"]').next('input[name="wallet_password"]'), showMsg: a.children().children().filter('[data-wallet="paymsg"]')}, isNaN(dom.isBind) || (1 == dom.isBind ? dom.money ? void 0 == dom.wallet.attr("checked") && !dom.walletPsw.val() || "undefined" == dom.wallet.attr("checked") && !dom.walletPsw.val() ? K.triggerWTPsw(dom) : K.triggerWCPsw(dom) : F.black("您的钱包金额为0元，无法使用钱包支付！") : 0 == dom.isBind && K.triggerWalletToBind(dom))
        }, triggerWCPsw: function(a) {
            a.isEnough ? (a.walletPsw.val("").prev().filter('input[name="wallet"]').val(""), a.elem.children().filter("span.check-box").removeClass("check-selted").next().filter('input[name="wallet"]').attr("checked", !1), a.elem.next().find('input[name="pay_type"]').attr("checked", !1).prev("span.i-radio").removeClass("active"), a.elem.next().find('input[name="pay_type"]').each(function() {
                $(this).parent().is(":hidden") ? $(this).parent().slideDown("fast") : $(this).parent().hasClass("bankpay") && $(this).next().next().filter("p").html("银行卡(<em>请选择支付卡种</em>)")
            })) : (a.walletPsw.val("").prev().filter('input[name="wallet"]').val(""), a.elem.children().filter("span.check-box").removeClass("check-selted").next().filter('input[name="wallet"]').attr("checked", !1)), a.showMsg.length && a.showMsg.hide()
        }, triggerWTPsw: function(a) {
            a.isEnough ? (a.elem.children().filter("span.check-box").addClass("check-selted").next().filter('input[name="wallet"]').attr("checked", !0), a.elem.next().find('input[name="pay_type"]').each(!isNaN(a.totleMoney - a.money) && a.totleMoney - a.money > 0 && a.totleMoney - a.money < 11 ? function() {
                50 == $(this).val() ? $(this).attr("checked", !0).prev().removeClass("active") : 8 == $(this).val() ? ($(this).parent().slideUp("fast"), $(this).attr("checked", !1).prev().removeClass("active")) : $(this).parent().hasClass("bankpay") ? ($(this).attr("checked", !1).prev().removeClass("active"), $(this).next().next().filter("p").html("银行卡(<em>请选择支付卡种</em>)")) : $(this).attr("checked", !1).prev().removeClass("active")
            } : function() {
                50 == $(this).val() ? $(this).attr("checked", !0).prev().removeClass("active") : 8 == $(this).val() ? ($(this).parent().slideDown("fast"), $(this).attr("checked", !1).prev().removeClass("active")) : $(this).parent().hasClass("bankpay") ? ($(this).attr("checked", !1).prev().removeClass("active"), $(this).next().next().filter("p").html("银行卡(<em>请选择支付卡种</em>)")) : $(this).attr("checked", !1).prev().removeClass("active")
            })) : a.elem.children().filter("span.check-box").addClass("check-selted").next().filter('input[name="wallet"]').attr("checked", !0), a.showMsg.length && a.showMsg.show()
        }, triggerWalletToBind: function() {
            location.href = "user-wallet-bind-send.html"
        }, tiggerInvoice: function() {
            var a = $(this), b = {elem: a, pars: a.parent(), next: a.parent().next()};
            b.next.is(":hidden") ? b.pars.slideUp().next().slideDown() : (b.pars.slideUp().next().slideDown(), b.pars.slideUp().prev().slideDown(), b.elem.parent().prev().children().find(".companyname").html("" != $.trim(b.elem.parent().children().filter('input[name="invoice"]').val()) ? b.elem.parent().children().filter('input[name="invoice"]').val() : "点击填写发票"))
        }, tiggerOrderFailForm: function() {
            var a = $(this).parents('[data-formorder="checkfailForm"]'), b = {elem: $(this), html: $(this).html(), width: $(this).outerWidth(), mLeft: $(this).outerWidth() / 2, payType: a.find("input[name='pay_type']"), pay_type: a.find("input[name='pay_type'][checked]").val(), pay_bank: a.find("input[name='pay_type'][checked]"), ispos: a.find("input[name='pay_type'][checked]").attr("data-ispos"), orders: a.find("input[name='pay_type'][checked]").attr("data-orders"), bankid: a.find("input[name='pay_type'][checked]").attr("data-bankid"), cashier: a.find("input[name='pay_type'][checked]").attr("data-cashier"), old_paytype_id: a.find("input[name='old_paytype_id']"), old_bank_id: a.find("input[name='old_bank_id']")};
            return b.pay_type < 0 ? b.pay_type = -1 * b.pay_type : b.pay_type, b.payType.length > 0 ? !b.payType.is("[checked]") && isNaN(b.pay_type) ? (F.black("请选择支付方式"), VmPageEffect.sharkError(a.children('[data-twicecart="payway"]'), "ui-note-error", !0, 0, 5, 44), !1) : b.pay_type < 1 ? (F.black("请选择支付方式"), VmPageEffect.sharkError(a.children('[data-twicecart="payway"]'), "ui-note-error", !0, 0, 5, 44), !1) : (K.triggerTwicePayDo(b), !1) : (F.black("请选择支付方式"), VmPageEffect.sharkError(a.children('[data-twicecart="payway"]'), "ui-note-error", !0, 0, 5, 44), !1)
        }, triggerTwicePayDo: function(a) {
            if (a.elem.html("&nbsp;"), $("<div />", {"class": "navbar-mask"}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;margin-right:10px;" />' + a.elem.attr("data-loading-text")).appendTo(a.elem.parent()), a.pay_type && a.pay_bank.val() < 0 && 2 === a.pay_type)
                var b = {url: "index.php?", data: {m: "ajax", act: "modify_order_paytype", orders: a.orders, pay_type: a.pay_bank.attr("data-type"), use_pos: a.ispos, bank_id: a.bankid, is_cashier: a.cashier, old_paytype_id: a.old_paytype_id.val(), old_bank_id: a.old_bank_id.val()}, dataType: "json", type: "POST"};
            else
                var b = {url: "index.php?", data: {m: "ajax", act: "modify_order_paytype", orders: a.orders, pay_type: a.pay_type, use_pos: a.ispos, old_paytype_id: a.old_paytype_id.val(), old_bank_id: a.old_bank_id.val()}, dataType: "json", type: "POST"};
            b.success = function(b) {
                a.elem.html(a.html).next().remove(), b && null != b && void 0 != b ? 1 == b.code ? (a.bankid && a.old_bank_id.val(a.bankid), b.repay_url ? location.href = b.repay_url : 8 == a.pay_type && (location.href = b.order_detail_url)) : 0 == b.code && F.black(b.msg) : F.black("网络延时，提交订单失败")
            }, b.error = function() {
                a.elem.html(a.html).next().remove(), F.black("网络延时，提交订单失败")
            }, $.ajax(b)
        }, triggerChooseBankCart: function() {
            var a = $(this), b = a.parents("li").children().filter('input[name="pay_type"]'), c = {elem: a, child: a.parents(".dropdiv"), childs: a.children().filter("span"), id: a.children().filter("span").data("bankid"), type: parseInt(a.children().filter("span").attr("data-type")), selbox: a.parents("li").children().filter("span.i-radio"), sibs: a.parents("li").siblings("li").children().filter("span.i-radio"), prev: a.parent().parent().prev().children().children().filter("span.cur"), scrol: a.parents("li"), slide: !0, pay_type: parseInt(b.val()), pay_bank: parseInt(b.val()), pay: a.parent().parent().attr("data-twipay"), orders: b.attr("data-orders"), ispos: b.attr("data-ispos"), payid: a.children().filter("span").attr("data-type"), bankid: a.children().filter("span").attr("data-bankid"), cashier: b.attr("data-cashier"), showText: a.parents(".bankpay").children().filter("p")};
            c.pay_type < 0 ? c.pay_type = -1 * c.pay_type : c.pay_type, c.pay = "true" === c.pay ? !0 : !1, c.childs.hasClass("sz_seleted") ? (c.selbox.addClass("active").next().filter('input[type="radio"]').attr("data-bankid", c.id).attr("data-type", c.type).attr("checked", !0), c.sibs.hasClass("active") && c.sibs.removeClass("active").next().filter('input[type="radio"]').attr("checked", !1)) : (c.childs.addClass("sz_seleted").parent().siblings().children().filter("span").removeClass("sz_seleted"), c.elem.parent().siblings().children().children().filter("span").removeClass("sz_seleted"), c.selbox.addClass("active").next().filter('input[type="radio"]').attr("data-bankid", c.id).attr("data-type", c.type).attr("checked", !0), c.sibs.hasClass("active") && c.sibs.removeClass("active").next().filter('input[type="radio"]').attr("checked", !1), c.showText.html(c.elem.text()), "boolean" == typeof c.pay && c.pay && K.triggerTwicePayDo(c), K.triggerBankUp.call(c))
        }, triggerAddAddress: function(a) {
            var b = a.target.href;
            a.preventDefault(), window.countAddressList >= 5 ? F.black("抱歉，地址最多为5个哦<br />可修改或删除原来地址重新添加！") : location.href = b
        }}, L = {triggerAddBonus: function() {
            var a = $(this), b = {pars: a.parent(), val: a.prev().val(), pageUrl: a.next().val(), type: parseInt(a.attr("data-bonustype"))};
            switch (b.type) {
                case 1:
                    var c = {url: "index.php", data: {m: "user", act: "bonus", step: "add", favourable_code: b.val}, dataType: "json", type: "POST"};
                    b.txt = "请输入代金券号码", L.triggerAddBonusTo(c, b);
                    break;
                case 2:
                    var c = {url: "index.php", data: {m: "user", act: "giftcard", step: "add", favourable_code: b.val}, dataType: "json", type: "POST"};
                    b.txt = "请输入礼品卡号码", L.triggerAddBonusTo(c, b);
                    break;
                case 3:
                    var c = {url: "ajaxapi-addcoupon.html?", data: {act: "coupon", favourable_code: b.val}, dataType: "json", type: "POST"};
                    b.txt = "请输入优惠券号码", L.triggerAddBonusTo(c, b);
                    break;
                default:
                    o.buttons = ["取消"]
                }
        }, triggerAddBonusTo: function(a, b) {
            return"" == b.val || "" == b.val.length || b.val.length < 1 ? (F.black(b.txt), !1) : (3 == b.type ? (a.success = function(a) {
                a && null != a && void 0 != a && (a.status && 1 == a.code ? VsmCart.VsmDialog(a.msg, {setClass: "ui-modal-singleBtn", overClose: !1, buttons: !0, type: "defined", buttonsCus: [{name: "确定", attribute: !1}], onDoComplete: function(a, b) {
                        b.oncomplete(!1), self.location.href = location.href
                    }}) : F.black(a.status || a.code ? a.msg : a.msg))
            }, a.error = function() {
                F.black("网络延时，请刷新页面重试")
            }) : (a.success = function(a) {
                a && null != a && void 0 != a && (0 == a.code ? (VsmCart.VsmDialog(a.msg, {setClass: "ui-success", overShow: !1, overClose: !1, position: [{top: 0}, {left: 0}], width: "100%", autoClose: 3e3}), setTimeout(function() {
                    self.location.href = location.href
                }, 3e3)) : F.black(1 == a.code ? a.msg : "网络延时，请刷新页面重试"))
            }, a.error = function() {
                F.black("网络延时，请刷新页面重试")
            }), void $.ajax(a))
        }, tiggeruseBonus: function(a, b) {
            var a = a, c = "您已经使用了";
            return 1 > a ? !1 : void $.get("index.php?m=flow&act=bonus&step=use_bonus", {bonus_id: a}, function(a) {
                if (1 == a.code)
                    switch (b) {
                        case 1:
                            VsmCart.VsmDialog(c + "代金券", {setClass: "ui-success", overShow: !1, overClose: !1, position: [{top: 0}, {left: 0}], width: "100%", autoClose: 3e3}), self.location.href = a.url;
                            break;
                        case 2:
                            VsmCart.VsmDialog(c + "礼品卡", {setClass: "ui-success", overShow: !1, overClose: !1, position: [{top: 0}, {left: 0}], width: "100%", autoClose: 3e3}), self.location.href = a.url
                        }
            }, "json")
        }, tiggeruseCoupon: function() {
            var a = new Array, b = "您已经使用了";
            return $.each($("input[name='coupon']"), function() {
                $(this).is("[checked]") && a.push($(this).val())
            }), a.length < 1 ? void F.black("请选择优惠券") : void $.post("index.php?m=flow&act=bonus&step=use_coupon", {coupons: a.join(",")}, function(a) {
                if (1 == a.code)
                    VsmCart.VsmDialog(b + "优惠券, 正在跳回购物车页面", {setClass: "ui-success", overShow: !1, overClose: !1, position: [{top: 0}, {left: 0}], width: "100%", autoClose: 3e3}), setTimeout(function() {
                        self.location.href = "cart.html"
                    }, 3e3);
                else if (-1 == a.code)
                    return F.black("购物车中的商品不满足使用优惠券条件"), !1
            }, "json")
        }, triggerSelCoupon: function() {
            var a = $(this), b = {elem: a, child: a.children().filter("input"), check: a.children().filter('input[name="coupon"]')};
            b.child.is(":radio") ? b.elem.hasClass("selected") || b.check.attr("checked") ? "" : b.elem.addClass("selected").children().filter('input[name="coupon"]').attr("checked", !0).parent().siblings('[data-selcoupon="true"]').removeClass("selected").children().filter('input[name="coupon"]').attr("checked", !1) : b.elem.hasClass("selected") || b.check.attr("checked") ? b.elem.removeClass("selected").children().filter('input[name="coupon"]').attr("checked", !1) : b.elem.addClass("selected").children().filter('input[name="coupon"]').attr("checked", !0).parent().siblings('[data-selcoupon="true"]').children().filter('input[type="radio"]').attr("checked", !1).parent().removeClass("selected")
        }}, M = {triggerTabselect: function() {
            var a = $(this), b = {elem: a, child: a.children(), index: p.children().index(this)};
            b.child.addClass("nav_current").parent().siblings().children().filter("a").removeClass("nav_current"), q.filter(":visible").fadeOut("fast", function() {
                q.eq(b.index).fadeIn("fast")
            })
        }, autoSetTabselect: function() {
            this.pars.children("li").length && (this.pars.children("li").filter(":eq(0)").children("a").addClass("nav_current"), this.next.filter(":eq(0)").show().siblings(".use-bonus").hide())
        }, triggerAutoTab: function() {
            this.pars.children("li").filter('[data-type="' + this.type + '"]').children("a").addClass("nav_current").parent().siblings().children().filter("a").removeClass("nav_current"), this.next.filter('[data-type="' + this.type + '"]').show().siblings(".use-bonus").hide()
        }, triggerBonusFocus: function() {
            var a = $(this), b = {elem: a, next: a.parent().next().filter("div.inputtips"), nextBtn: a.next().filter('input[type="button"]'), clsName: a.attr("data-cname")};
            b.elem.addClass("focus").parent().next().filter("div.inputtips").fadeIn("fast"), b.nextBtn.removeClass("btn_gry").addClass("" + b.clsName).attr("disabled", !1)
        }, triggerBonusBlur: function() {
            var a = $(this), b = {elem: a, next: a.parent().next().filter("div.inputtips"), nextBtn: a.next().filter('input[type="button"]'), clsName: a.attr("data-cname")};
            b.next.fadeOut("fast"), "" != b.elem.val() && b.elem.val().length ? b.nextBtn.removeClass("btn_gry").addClass("" + b.clsName).attr("disabled", !1) : b.nextBtn.removeClass("" + b.clsName).addClass("btn_gry").attr("disabled", !0)
        }, triggerChecked: function() {
            this.next.text("反选"), this.checkBox.attr("checked", "checked")
        }, triggerNotChecked: function() {
            this.next.text("全选"), this.checkBox.attr("checked", !1)
        }, triggerCheckBonus: function() {
            var a = $(this), b = {elem: a, next: a.next(), checkBox: a.parents("table").children().find('input[name="coupon"]').filter('input[type="checkbox"]')};
            b.elem.is(":checked") ? L.triggerChecked.call(b) : L.triggerNotChecked.call(b)
        }}, N = {triggerChooseallList: function() {
            var a = $(this), b = {elem: a, child: a.children("span.check-box"), nspan: a.next().find("span.check-box")};
            b.child.hasClass("check-selted") ? N.triggerClAll.call(b) : N.triggerChAll.call(b)
        }, triggerChAll: function() {
            this.child.addClass("check-selted"), this.nspan.addClass("check-selted").next().filter('input[name="good_id"]').attr("checked", !0)
        }, triggerClAll: function() {
            this.child.removeClass("check-selted"), this.nspan.removeClass("check-selted").next().filter('input[name="good_id"]').attr("checked", !1)
        }, triggerChooseList: function() {
            var a = $(this), b = {elem: a, child: a.children("span.check-box"), pspan: a.parent().prev().children("span.check-box"), silb: a.siblings(".orderdeatil").children("span.check-box")};
            b.child.hasClass("check-selted") ? N.triggerClThis.call(b) : N.triggerChThis.call(b)
        }, triggerChThis: function() {
            this.child.addClass("check-selted").next().filter('input[name="good_id"]').attr("checked", !0), this.pspan.addClass("check-selted")
        }, triggerClThis: function() {
            this.child.removeClass("check-selted").next().filter('input[name="good_id"]').attr("checked", !1), (!this.silb.hasClass("check-selted") && void 0 == this.silb.next().filter('input[name="good_id"]').attr("checked") || !this.silb.hasClass("check-selted") && "undefined" == this.silb.next().filter('input[name="good_id"]').attr("checked")) && this.pspan.removeClass("check-selted")
        }, triggerChooseReason: function() {
            var a = $(this), b = {elem: a, child: a.children("i"), rid: parseInt(a.attr("data-reasonid")), rinput: a.parent().children('input[name="reason_id"]')};
            !isNaN(b.rid) && b.rid && b.child.hasClass("seleted") ? N.triggerCLsel.call(b) : N.triggerCRsel.call(b)
        }, triggerCRsel: function() {
            this.child.addClass("seleted").parent().siblings().filter("a").children().removeClass("seleted"), this.rinput.val(this.rid)
        }, triggerCLsel: function() {
            this.child.removeClass("seleted"), this.rinput.val("")
        }, triggerChooseWay: function() {
            var a = $(this), b = {elem: a, child: a.children("i"), rid: a.attr("data-backway"), rinput: a.parent().children('input[name="return_type"]')};
            !isNaN(b.rid) && b.child.hasClass("seleted") ? N.triggerCLsel.call(b) : N.triggerCRsel.call(b)
        }, triggerOrderSub: function() {
            var a = ($(this), {goodid: $('input[name="good_id"]'), reson: $('input[name="reason_id"]').val(), way: $('input[name="return_type"]').val(), orderid: $('input[name="order_sn"]').val(), formact: $('input[name="form_act"]').val()}), b = new Array, c = I.tiggerIsEmpty(a.reson), d = I.tiggerIsEmpty(a.way);
            if ($.each(a.goodid, function(a, c) {
                1 == c.checked && b.push(c.value)
            }), b.length < 1)
                return F.black("请选择退货商品"), !1;
            if (!c)
                return F.black("请选择退货原因"), !1;
            if (!d)
                return F.black("请选择余额退回方式"), !1;
            var e = {url: "index.php?", data: {m: "user", act: "order", step: "return", form_act: a.formact, good_id: b.join(","), reason_id: a.reson, return_type: a.way, order_sn: a.orderid}, dataType: "json", type: "POST"};
            e.success = function(a) {
                a && null != a && void 0 != a ? 1 == a.status ? (VsmCart.VsmDialog(a.msg + "页面正在跳转", {setClass: "ui-success", overShow: !1, overClose: !1, position: [{top: 0}, {left: 0}], width: "100%", autoClose: 3e3}), setTimeout(function() {
                    self.location.href = a.url
                }, 3e3)) : F.black(0 == a.status ? a.msg : "退货失败，请刷新页面重试") : F.black("退货失败，请刷新页面重试")
            }, e.error = function() {
                F.black("退货失败，请刷新页面重试")
            }, $.ajax(e)
        }}, O = {triggerAddressinit: function() {
            var a = $(this), b = $(this).parents().filter('form[name="addressForm_"]'), c = {elem: a, elemTxt: a.val(), address_id: b.find('input[name="address_id"]').val(), filter: b.find('input[name="filter"]').val(), flag: b.find('input[name="flag"]').val(), mkobj: b.find('input[name="mk"]'), consignee: b.find('input[name="consignee"]').val(), province_id: b.find('select[name="province"] option:selected').val(), city_id: b.find('select[name="city"] option:selected').val(), district_id: b.find('select[name="district"] option:selected').val(), street_id: b.find('select[name="street"] option:selected').val(), address: b.find('textarea[name="address"]').val(), mobile: b.find('input[name="mobile"]').val(), postcode: b.find('input[name="postcode"]').val(), transport_day: b.find('select[name="transport_day"] option:selected').val(), refererParam: b.find('input[name="refererParam"]').val() || "", istempuser: a.data("istempuser")};
            if ("undefined" == c.mkobj || void 0 == c.mkobj)
                var d = "";
            else
                var d = c.mkobj.val();
            if ("update" == c.filter && c.address_id.length < 1)
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "地址异常" : "地址异常"), !1;
            if (c.consignee.length < 1)
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "请填写收货人姓名" : "请填写收货人姓名"), b.find('input[name="consignee"]').focus(), VmPageEffect.sharkError($('input[name="consignee"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (!E.c.test($.trim(c.consignee)))
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "请填写1~8位中文姓名" : "请填写1~8位中文姓名"), b.find('input[name="consignee"]').focus(), VmPageEffect.sharkError($('input[name="consignee"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (c.mobile.length < 1 && "" == c.mobile)
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "手机号码不能为空" : "手机号码不能为空"), b.find('input[name="mobile"]').focus(), VmPageEffect.sharkError($('input[name="mobile"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (c.mobile.length > 0 && !E.m.test(c.mobile))
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "手机号码格式错误" : "手机号码格式错误"), b.find('input[name="mobile"]').focus(), VmPageEffect.sharkError($('input[name="mobile"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (null == c.province_id || c.province_id < 1)
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "请选择省" : "请选择省"), VmPageEffect.sharkError($('select[name="province"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (null == c.city_id || c.city_id < 1)
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "请选择市" : "请选择市"), VmPageEffect.sharkError($('select[name="city"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (null == c.district_id || c.district_id < 1)
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "请选择区" : "请选择区"), VmPageEffect.sharkError($('select[name="district"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (null == c.transport_day || c.transport_day < 1)
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "请选择收货时间" : "请选择收货时间"), VmPageEffect.sharkError($('select[name="transport_day"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (c.address.length < 1)
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "请填写详细地址" : "请填写详细地址"), VmPageEffect.sharkError($('textarea[name="address"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (6 != c.postcode.length || isNaN(c.postcode))
                return F.black("boolean" == typeof c.istempuser && c.istempuser ? "邮编错误" : "邮编错误"), VmPageEffect.sharkError($('input[name="postcode"]').parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (c.elem.val(""), $("<div />", {"class": "ui-btn-mask"}).css({height: c.elem.outerHeight()}).html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;" /> ' + c.elem.attr("data-loading-text")).appendTo(c.elem.parent()), "boolean" == typeof c.istempuser && c.istempuser) {
                var e = {url: "ajaxapi-adduseraddress.html", data: {consignee: c.consignee, province: c.province_id, city: c.city_id, district: c.district_id, street: c.street_id, transport_day: c.transport_day, address: c.address, postcode: c.postcode, mobile: c.mobile}, dataType: "json", type: "POST"};
                e.success = function(a) {
                    200 == a.code ? (c.elem.next().html('<img src="view/touch/images/common/loading-big.gif" style="width:20px;" />页面正在跳转'), self.location.href = "cart-checkout.html") : 1 == a.code && a.msg.length > 0 ? (c.elem.next().remove(), c.elem.val(c.elemTxt), F.black(a.msg)) : -1 == a.code && a.msg.length > 0 && (c.elem.next().remove(), c.elem.val(c.elemTxt), F.black(a.msg))
                }, e.error = function() {
                    c.elem.next().remove(), c.elem.val(c.elemTxt), F.black("网络延时，请刷新页面重试")
                }, $.ajax(e)
            } else {
                var e = {url: "index.php?m=user&act=address&step=save", data: {filter: c.filter, address_id: c.address_id, consignee: c.consignee, province: c.province_id, city: c.city_id, district: c.district_id, street: c.street_id, transport_day: c.transport_day, address: c.address, postcode: c.postcode, mobile: c.mobile, flag: c.flag, mk: d, refererParam: c.refererParam}, dataType: "json", type: "POST"};
                e.success = function(a) {
                    c.elem.next().remove(), c.elem.val(c.elemTxt), 1 == a.error && a.message.length > 0 ? "default" == ui ? alert(a.message) : F.black(a.message) : -1 == a.error && a.url.length > 0 && (location.href = a.url)
                }, e.error = function() {
                    c.elem.next().remove(), c.elem.val(c.elemTxt), F.black("网络延时，请刷新页面重试")
                }, $.ajax(e)
            }
            return!1
        }, triggerDelAddress: function() {
            var a = $(this), b = {elem: a, id: parseInt(a.attr("data-addressid"))};
            !isNaN(b.id) && b.id && VsmCart.VsmDialog('<p style="text-align:center">你要删除该地址吗？', {setClass: "ui-modal-doubleBtn", buttons: !0, type: "defined", buttonsCus: [{name: "取消", attribute: !1}, {name: "删除", attribute: !0}], onDoComplete: function(a, b) {
                    b.oncomplete(!1)
                }, onDoCompleteTo: function(a, c) {
                    c.oncomplete(!1);
                    var d = {url: "index.php?", data: {m: "user", act: "address", step: "edit", filter: "del", address_id: b.id}, dataType: "json", type: "POST"};
                    d.success = function(a) {
                        a && null != a && void 0 != a && 0 == a.code && (countAddressList--, setTimeout(function() {
                            self.location.href = location.href
                        }, 3e3))
                    }, d.error = function() {
                        F.black("网络延时，请刷新页面重试")
                    }, $.ajax(d)
                }})
        }}, P = {inputInit: function() {
            var a = {icheck: $('input[name="check_code"]').length ? $('input[name="check_code"]') : null, wcheck: $('input[name="pswend"]').length ? $('input[name="pswend"]') : null, txtcheck: $('[data-setforms="true"]').find('textarea[name="reason"]').length ? $('[data-setforms="true"]').find('textarea[name="reason"]') : null};
            null != a.icheck && P.inputOpera.call(a.icheck, 1), null != a.wcheck && P.inputOpera.call(a.wcheck, 1), null != a.txtcheck && P.inputOpera.call(a.txtcheck, 2)
        }, inputOpera: function(a) {
            1 == a ? this.length && this.on("keyup", function() {
                "" != $.trim($(this).val()) && $(this).val().length > 0 ? $(this).next().next().attr("disabled", !1).removeClass("btn_gry").addClass("btn_red") : $(this).next().next().attr("disabled", !0).removeClass("btn_red").addClass("btn_gry")
            }).on("change", function() {
                "" != $.trim($(this).val()) && $(this).val().length > 0 ? $(this).next().next().attr("disabled", !1).removeClass("btn_gry").addClass("btn_red") : $(this).next().next().attr("disabled", !0).removeClass("btn_red").addClass("btn_gry")
            }) : 2 == a && this.length && this.on("keyup", function() {
                "" != $.trim($(this).val()) && $(this).val().length > 0 ? $(this).parents('[data-setforms="true"]').find('[data-theme="true"]').attr("disabled", !1).removeClass("btn_gry").addClass("btn_red") : $(this).parents('[data-setforms="true"]').find('[data-theme="true"]').attr("disabled", !0).removeClass("btn_red").addClass("btn_gry")
            }).on("change", function() {
                "" != $.trim($(this).val()) && $(this).val().length > 0 ? $(this).parents('[data-setforms="true"]').find('[data-theme="true"]').attr("disabled", !1).removeClass("btn_gry").addClass("btn_red") : $(this).parents('[data-setforms="true"]').find('[data-theme="true"]').attr("disabled", !0).removeClass("btn_red").addClass("btn_gry")
            })
        }, cartInit: function() {
            var a = {elem: $('[data-shopcarthide="true"]').length}, b = {elem: $('[data-shopcart="true"]').find(".u-flow-carttime"), time: parseInt($('[data-shopcart="true"]').attr("shopcarttime")), timeUnitCls: {day: "", hour: "", min: ":", sec: ""}, action: "remain", onEndCallBack: !0, onEndComplete: function() {
                    this.html("").add(this.prev().html("")).hide()
                }};
            a.elem ? $(".shoppingbags").remove() : b.elem.length && b.time > 0 && VsmCart.countdown(b)
        }, tabInit: function() {
            var a = location.href, b = VmPageEffect.localUrl(a), c = {pars: p, next: q, type: b.params.tabType ? b.params.tabType : null};
            isNaN(c.type) && null != c.type ? M.triggerAutoTab.call(c) : M.autoSetTabselect.call(c)
        }, bindEvents: function() {
            a.off("click.button.code").on("click.button.code", J.tiggergetCodeinit), b.off("click.button.method").on("click.button.method", J.tiggerverCheckinit), c.off("click.button.psw").on("click.button.psw", J.tiggerpswCheckinit), d.off("click.button.feedbacksend").on("click.button.feedbacksend", J.tiggerFBSendinit), e.off("click.choice.size", "li").on("click.choice.size", "li", H.tiggerMerSize), f.off("click.add.beauty").on("click.add.beauty", G.tiggerBeautyaddCartinit), g.off("click.orderfailform.set").on("click.orderfailform.set", K.tiggerOrderFailForm), i.children().find("li").off("click.choose.time").on("click.choose.time", K.triggerChooseInfo), h.children().find("li").off("click.choose.time").on("click.choose.time", K.triggerChooseInfo), j.children(".in_pay").children().children().filter("li.otherpay").off("click.choose.pay").on("click.choose.pay", K.triggerChoosePayway), j.children(".in_pay").children().children().filter("li.bankpay").children("p").off("click.choose.bankpay").on("click.choose.bankpay", K.triggerBankList), j.children(".payinwallet").off("click.choose.wallet").on("click.choose.wallet", K.triggerChooseWallet), m.children().children().filter("li.otherpay").off("click.twicechoose.pay").on("click.twicechoose.pay", K.triggerChoosePayway), m.children().children().filter("li.bankpay").children("p").off("click.twicechoose.pay").on("click.twicechoose.pay", K.triggerBankList), n.off("click.twiceChoose.wallet").on("click.twiceChoose.wallet", K.triggerChooseWallet), k.children().children().filter("h3").off("click.invoice.set").on("click.invoice.set", K.tiggerInvoice), u.children(".orderlisttit").off("click.reorder.list").on("click.reorder.list", N.triggerChooseallList), u.children().children().filter(".orderdeatil").off("click.reorder.list").on("click.reorder.list", N.triggerChooseList), v.children().filter("a").off("click.rereason.reason").on("click.rereason.reason", N.triggerChooseReason), w.children().filter("a").off("click.reway.way").on("click.reway.way", N.triggerChooseWay), x.off("click.Ordersub.sub").on("click.Ordersub.sub", N.triggerOrderSub), y.off("click.commit.address").on("click.commit.address", O.triggerAddressinit), z.off("click.del.address").on("click.del.address", O.triggerDelAddress), B.children().filter("li").off("click.choose.banktype").on("click.choose.banktype", K.triggerBankMenu), C.children().children().filter("li").off("click.choose.carttype").on("click.choose.carttype", K.triggerChooseBankCart), l.off("click.emptyText").on("click.emptyText", empty_text), D.click(K.triggerAddAddress)
        }, bindBonusEvents: function() {
            p.children("li").off("click.select.tab").on("click.select.tab", M.triggerTabselect), r.children('input[name="favourable_code"]').on("focus", M.triggerBonusFocus).on("blur", M.triggerBonusBlur), s.off().off("click.CheckBonus").on("click.CheckBonus", M.triggerCheckBonus), t.off("click.add.Bonus").on("click.add.Bonus", L.triggerAddBonus), A.off("click.selCoupon").on("click.selCoupon", L.triggerSelCoupon)
        }, autoEvent: function() {
            p.length && P.tabInit()
        }, init: function() {
            P.bindEvents(), P.inputInit(), P.cartInit(), P.autoEvent(), P.bindBonusEvents(), window.VIP && -1 === location.pathname.indexOf("brand-search") && (VIP.util.navFix($("#nav")), VIP.util.backToTopFix(), VIP.util.downloadApp.init())
        }};
    return{init: P.init, onfocus: P.inputOpera, useBonus: L.tiggeruseBonus, useCoupon: L.tiggeruseCoupon, validatePsw: I.validatePsw, dataType: E, validate: I, dialogDialog: F.black, sizeDefault: H.sizeDefault, getSize: H.tiggerMerSize, beautyaddcart: G.tiggerLoginBaddCartinit, tiggerBeautyaddCartinit: G.tiggerBeautyaddCartinit, addCartByData: G.addCartByData}
}();
$(function() {
    VsmwebForm.init()
});
var VsmWebConfig = function() {
    var a = {getScroll: function() {
            return self.pageYOffset ? {scrollTop: self.pageYOffset, scrollLeft: self.pageXOffset} : document.documentElement && document.documentElement.scrollTop ? {scrollTop: document.documentElement.scrollTop, scrollLeft: document.documentElement.scrollLeft} : document.body ? {scrollTop: document.body.scrollTop, scrollLeft: document.body.scrollLeft} : void 0
        }};
    return{scroll: a.getScroll}
}(), VsmScroll = function() {
    var a = {elemId: function(a) {
            return document.getElementById(a)
        }}, b = function(a) {
        if (a) {
            this.element = a, this.child = this.element.children[0], this.dom = {elem: $(this.child), height: $(this.element).prev().innerHeight()}, this.addEvent()
        }
    };
    return b.prototype = {addEvent: function() {
            this.element.addEventListener && (this.element.addEventListener("touchstart", this, !1), this.element.addEventListener("touchmove", this, !1), this.element.addEventListener("touchend", this, !1))
        }, removeEvent: function() {
            this.element.addEventListener && (this.element.removeEventListener("touchstart", this, !1), this.element.removeEventListener("touchmove", this, !1), this.element.removeEventListener("touchend", this, !1))
        }, handleEvent: function(a) {
            switch (a.type) {
                case"touchstart":
                    this.onTouchStart(a);
                    break;
                case"touchmove":
                    this.onTouchMove(a);
                    break;
                case"touchend":
                    this.onTouchEnd(a)
                }
        }, onTouchStart: function(a) {
            this.start = {pageX: a.touches[0].pageX, pageY: a.touches[0].pageY, time: Number(new Date)}, this.isScrolling = void 0, this.deltaX = 0, this.deltaY = 0, a.stopPropagation()
        }, onTouchMove: function(a) {
            return a.touches.length > 1 || a.scale && 1 !== a.scale ? void 0 : (this.move = {deltaX: a.touches[0].pageX - this.start.pageX, deltaY: a.touches[0].pageY - this.start.pageY}, this.move.deltaY < -5 ? void this.dom.elem.css({position: "static"}).next().removeAttr("style") : this.move.deltaY > 5 ? void this.dom.elem.css({position: "fixed", width: "100%", top: this.dom.height, "z-index": "1000", left: "0"}).next().css("marginTop", this.dom.elem.innerHeight()) : void 0)
        }, onTouchEnd: function(a) {
            return this.end = {deltaX: a.changedTouches[0].pageX - this.start.pageX, deltaY: a.changedTouches[0].pageY - this.start.pageY}, this.end.deltaY < -5 ? void this.dom.elem.css({position: "static"}).next().removeAttr("style") : this.end.deltaY > 5 ? void this.dom.elem.css({position: "fixed", width: "100%", top: this.dom.height, "z-index": "1000", left: "0"}).next().css("marginTop", this.dom.elem.innerHeight()) : void a.stopPropagation()
        }}, {Swipes: b, elemId: a.elemId}
}(), VsmFonEffect = function() {
    var a = ($("#cart_list"), $('[data-isRegister="check"]')), b = $('[data-countTemporary="true"]'), c = $('[data-bindmethods="psw"]'), d = {register: function() {
            var a = VsmwebForm.validate, b = $(this), c = $(this).parents('[data-register="send"]'), d = {elem: b, pars: c, consignee: c.find('input[name="consignee"]'), mobile: c.find('input[name="mobile"]'), captchaDisplay: document.getElementById("li_captcha").style.display, captcha: c.find('input[name="captcha"]'), captchaImg: c.find("img#captcha")};
            if (!a.tiggerIsEmpty(d.consignee.val()) && "" == d.consignee.val())
                return VsmwebForm.dialogDialog("请填写收货人姓名"), d.consignee.focus(), VmPageEffect.sharkError(d.consignee.parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (a.tiggerIsEmpty(d.consignee.val()) && !VsmwebForm.dataType.c.test($.trim(d.consignee.val())))
                return VsmwebForm.dialogDialog("请填写1~8位中文姓名"), d.consignee.focus(), VmPageEffect.sharkError(d.consignee.parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (!a.tiggerIsEmpty(d.mobile.val()) && "" == d.mobile.val())
                return VsmwebForm.dialogDialog("手机号码不能为空"), d.mobile.focus(), VmPageEffect.sharkError(d.mobile.parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (a.tiggerIsEmpty(d.mobile.val()) && !VsmwebForm.dataType.m.test($.trim(d.mobile.val())))
                return VsmwebForm.dialogDialog("手机号码格式错误"), d.mobile.focus(), VmPageEffect.sharkError(d.mobile.parent().parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if ("none" != d.captchaDisplay && !a.tiggerIsEmpty(d.captcha.val()) && "" == d.captcha.val())
                return VsmwebForm.dialogDialog("请输入验证码"), d.captcha.focus(), VmPageEffect.sharkError(d.captcha.parent(), "ui-note-error", !1, 0, 5, 50), !1;
            var e = {url: "ajaxapi-verifyuserphone.html?", data: {consignee: d.consignee.val(), mobile: d.mobile.val(), captcha: d.captcha.val()}, dataType: "json", type: "POST"};
            e.error = function() {
                d.captchaImg.attr("src", "captcha.html?t=" + Math.random() + "&type=1"), VsmwebForm.dialogDialog("网络延时，请刷新页面重试")
            }, e.success = function(a) {
                d.captchaImg.attr("src", "captcha.html?t=" + Math.random() + "&type=1"), a && null != a && void 0 != a ? (1 == a.code ? ("" != a.userId && null != a.userId && Cookie.Set("wap_free_reg_id", a.userId, 24, "vip.com", "/"), c.next().find('input[name="consignee"]').val(d.consignee.val()), c.next().find('input[name="mobile"]').val(d.mobile.val()), d.pars.hide().next().show()) : 3 == a.code && a.url.length > 0 ? (VsmwebForm.dialogDialog(a.msg), self.location.href = a.url) : -2 == a.code ? VsmCart.VsmDialog('<p style="text-align:center;">该手机码已被注册，请登录</p>', {title: '唯品会提醒您<a href="http://www.vip.com/account/password.php" class="fr colorblue">忘记密码？</a>', setClass: "ui-modal-doubleBtn form-modal", overClose: !1, closeBtn: !1, buttons: !0, type: "defined", buttonsCus: [{name: "取消", attribute: !1}, {name: "登录", attribute: !0, mars_sead: "receive-massage_pop_login_btn"}], onDoComplete: function(a, b) {
                        b.oncomplete(!1)
                    }, onDoCompleteTo: function(a, b) {
                        b.oncomplete(!1), self.location.href = "login.html"
                    }}) : VsmwebForm.dialogDialog(-1 == a.code ? a.msg : a.msg), 1 == a.use_captcha && (document.getElementById("li_captcha").style.display = "")) : VsmwebForm.dialogDialog("网络延时，请刷新页面重试")
            }, $.ajax(e)
        }, setPassWord: function() {
            var a = VsmwebForm.validate, b = $(this), c = b.parent().parent(), d = {elem: b, pars: c, psw: c.find('input[name="password"]'), data: auth_data("", hex_md5($.trim(c.find('input[name="password"]').val())), "")};
            if (!a.tiggerIsEmpty(d.psw.val()) && "" == d.psw.val())
                return VsmwebForm.dialogDialog("请输入密码"), d.psw.focus(), VmPageEffect.sharkError(d.psw.parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (a.tiggerIsEmpty(d.psw.val()) && (d.psw.val().length < 6 || d.psw.val().length > 20))
                return VsmwebForm.dialogDialog("请输入6-20位密码"), d.psw.focus(), VmPageEffect.sharkError(d.psw.parent(), "ui-note-error", !1, 0, 5, 50), !1;
            if (!isNaN(d.psw.val()) || "-1" != d.psw.val().search(VsmwebForm.dataType.s))
                return VsmwebForm.dialogDialog("请使用字母和数字组合"), d.psw.focus(), !1;
            var e = {url: "ajaxapi-savatempuserpwd.html?", data: {udata: d.data}, dataType: "json", type: "POST"};
            e.error = function() {
                VsmwebForm.dialogDialog("网络延时，请刷新页面重试")
            }, e.success = function(a) {
                a && null != a && void 0 != a ? 1 == a.code ? (VsmCart.VsmDialog("设置密码成功，页面正在跳转", {setClass: "ui-success", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 1500}), setTimeout(function() {
                    self.location.href = "member_index.html"
                }, 1e3)) : VsmwebForm.dialogDialog(a.msg) : VsmwebForm.dialogDialog("网络延时，请刷新页面重试")
            }, $.ajax(e)
        }}, e = {countdown: function() {
            var a = $('[data-countTemporary="true"]'), b = {elem: a, time: parseInt(a.attr("data-orderTime")), showMin: !0, action: "defined", timeTag: "span.count", timeWarn: !1, timeUnitCls: {day: "", hour: "", min: ":", sec: ""}, onEndCallBack: !0, onEndComplete: function() {
                    this.children().html("00:00"), VsmCart.VsmDialog('<p style="text-align:center;">购物车超时了<br />请重新选购商品</p>', {setClass: "ui-modal-singleBtn", overClose: !1, buttons: !0, type: "defined", buttonsCus: [{name: "回首页逛逛", attribute: !1, mars_sead: "edit-detail-receive-massage_pop_back-to-home_btn"}], onDoComplete: function(a, b) {
                            b.oncomplete(!1), self.location.href = "index.html"
                        }})
                }};
            !isNaN(b.time) && b.time > 0 && VsmCart.countdown(b)
        }}, f = {init: function() {
            var a = {psw: c.parent().parent().find('input[name="password"]')};
            a.psw.length && VsmwebForm.onfocus.call(a.psw, 2)
        }}, g = {bindEvents: function() {
            a.off("click.registe.check").on("click.registe.check", d.register), c.off("click.password.set").on("click.password.set", d.setPassWord)
        }}, h = {init: function() {
            g.bindEvents(), b.length && e.countdown(), c.length && f.init()
        }};
    return{init: h.init}
}(), VsmwebEffect = function() {
    var a = ($('[data-GetBrand="more"]'), $('[data-GetDetail="more"]')), b = $('[data-thumbcate="list"]'), c = $(".drop_cate"), d = $("#B_cateWrap"), e = $("#B_listWrap"), f = $('[data-jump="true"]'), g = $('[data-collapse="true"]'), h = new VsmScroll.Swipes(VsmScroll.elemId("w_container")), i = {initPager: function() {
            var a = (VIP.util.getUserType(), $("#channel_img"));
            VIP.pager.config({el: a, reqData: {channel: a.data("channel"), menuid: a.data("menuid") || 0, typeid: a.data("typeid") || 0, oprPage: a.data("page") || ""}, mars: "index_page", page: {limit: 20}, url: "ajaxapi-brands.html?s=" + (new Date).getTime(), init: function() {
                    "1" == $("#channel_img").attr("data-float-progress") && this.initShowProcess()
                }, initShowProcess: function() {
                    var a = new VIP.ProcessTip;
                    a.init({el: $("#channel_img"), itemSelector: ".J_item-list img"})
                }, render: function(a) {
                    this.el.append(VIP.tmpl.getBrandList({data: a, cName: this.imageClassName}))
                }})
        }, initScrollEvent: function() {
        }, getBrandData: function(a) {
            a.elem.hide().before('<div class="u-loading"><img src="view/touch/images/common/loading-big.gif" alt="loading" />100%正品保证</div>'), $.ajax({url: "ajaxapi-brands.html?s=" + (new Date).getTime(), data: {index: a.total, channel: a.channel}, dataType: "json", type: "GET", success: function(b) {
                    var c = "";
                    a.elem.show().prev().fadeOut(function() {
                        $(this).remove(), null != b && void 0 != b && b && b.length > 0 ? (c = VIP.tmpl.getBrandList({data: b, cName: a.cName}), a.insertObj.append(c), VsmCart.imgNewEffect(a)) : 0 == b.length ? (a.elem.before('<div class="u-loading">亲，没有更多了</div>'), a.elem.hide().remove()) : VsmCart.VsmDialog("获取品牌列表失败", {overClose: !1})
                    })
                }, error: function() {
                    VsmCart.VsmDialog("网络延时，加载品牌列表失败，请刷新页面重试...", {}), a.elem.prev().fadeOut("fast", function() {
                        $(this).remove(), a.elem.fadeIn(function() {
                            $(this).off("click.asyn.loading")
                        }).css({color: "#999", "text-shadow": "0 -1px 0 rgba(255,255,255,1)"}).html("网络延时,请刷新页面")
                    })
                }})
        }, getBrandinit: function() {
            var a = $(this), b = {elem: a, channel: a.data("channel"), insertObj: a.prev().find("#channel_img"), total: parseInt(a.prev().find(".u-brand-list").length, 10), cName: a.prev().children().find("[data-original]").attr("class")};
            !isNaN(b.total) && b.total >= 0 && i.getBrandData(b)
        }, tiggerDetailinit: function() {
            var a = $(this), b = {elem: a, pid: a.prev().find('input[name="product_id"]').length ? a.prev().find('input[name="product_id"]').val() : null, child: a.next().children().filter(".loading"), check: a.data("merchandise").toString(), type: null};
            b.type = "" != b.check && "string" == typeof b.check && "normal" == b.check ? !0 : !1, null != b.pid && (b.elem.hide(), b.child.show(), i.tiggerDetailData(b))
        }, tiggerDetailData: function(a) {
            if (a.type)
                var b = {url: "ajaxapi-getproductdetail.html?" + (new Date).getTime(), data: {productid: a.pid}, type: "GET"};
            else
                var b = {url: "ajaxapi-getbeautydetail.html?" + (new Date).getTime(), data: {productid: a.pid}, type: "GET"};
            b.error = function() {
                a.child.fadeOut(function() {
                    VsmwebForm.dialogDialog("网络延时，请刷新页面重试")
                })
            }, b.success = function(b) {
                b && null != b && void 0 != b ? b.length > 0 && "" != b && null != b && a.child.fadeOut(function() {
                    $(this).prev().css({style: "display:none"}).html(b).fadeIn()
                }) : (a.elem.fadeIn(), a.child.fadeOut(function() {
                    VsmwebForm.dialogDialog("网络延时，请刷新页面重试")
                }))
            }, $.ajax(b)
        }, tiggerAccordionInit: function() {
            i.tiggerAccordion($(this))
        }, tiggerAccordion: function(a) {
            var b = {elem: a, next: a.next(), addStyle: a.parent().data("style"), child: a.children().filter(":eq(1)")};
            b.next.length && b.next.is(":hidden") ? (b.child.addClass("up_" + b.addStyle).removeClass("down_" + b.addStyle), b.elem.addClass("on").next().slideDown()) : (b.child.addClass("down_" + b.addStyle).removeClass("up_" + b.addStyle), b.elem.removeClass("on").addClass("off").next().slideUp())
        }}, j = {slidePageDown: function() {
            if (this.elem.next().fadeIn("fast").parent().addClass("active"), this.elem.parent().next().hasClass("active")) {
                var a = this.elem.parent().next().children().filter("a"), b = {elem: a, direction: a.attr("data-dropmen"), child: a.next().children().find("h2")};
                j.slidePageRight.call(b)
            }
        }, slidePageUp: function() {
            this.elem.next().fadeOut("fast").parent().removeClass("active")
        }, slidePageLeft: function() {
            var a = this.elem.next().outerWidth(!0), b = (parseInt(this.elem.next().css("top"), 10), {});
            if (!this.elem.next().is(":visible")) {
                switch (this.direction) {
                    case"left":
                        this.elem.next().css({left: "auto", right: "-" + a + "px", height: $(document).outerHeight()}), b.right = "+=" + a;
                        break;
                    default:
                        this.elem.next().css({left: "-" + a + "px", right: "auto"}), b.left = "+=" + a
                }
                if (this.elem.next().show().animate(b, "fast").parent().addClass("active"), this.elem.parent().prev().hasClass("active")) {
                    var c = this.elem.parent().prev().children().filter("a"), d = {elem: c, direction: c.attr("data-dropmen"), child: c.next().children().find("h2")};
                    j.slidePageUp.call(d)
                }
                this.elem.next().undelegate('[data-dropClose="true"]', "click.drop.close").delegate('[data-dropClose="true"]', "click.drop.close", j.slidePageBottom), document.addEventListener("touchmove", j.touchEvent, !1)
            }
        }, slidePageRight: function() {
            var a = this.elem.next().outerWidth(!0), b = {};
            if (!this.elem.next().is(":hidden")) {
                switch (this.direction) {
                    case"left":
                        b.right = "-=" + a;
                        break;
                    default:
                        b.left = "-=" + a
                }
                this.elem.next().animate(b, "fast", function() {
                    $(this).hide()
                }).parent().removeClass("active"), document.removeEventListener("touchmove", j.touchEvent, !1)
            }
        }, touchEvent: function(a) {
            a.preventDefault()
        }, slideCateinit: function() {
            var a = $(this), b = {elem: a, direction: a.attr("data-dropmen"), child: a.next().children().find("h2")};
            b.direction && "down" == b.direction ? b.elem.next().is(":visible") ? (h.addEvent(), j.slidePageUp.call(b)) : (h.removeEvent(), j.slidePageDown.call(b)) : b.elem.next().is(":visible") ? (h.addEvent(), j.slidePageRight.call(b)) : (h.removeEvent(), j.slidePageLeft.call(b))
        }, slidePageBottom: function() {
            var a = $(this), b = {elem: a.parents(".trasp").prev(), direction: "left"};
            b.elem.next().is(":visible") && j.slidePageRight.call(b)
        }, slideMenuinit: function() {
            var a = $(this), b = {elem: a, child: a.children("h2"), cartid: a.attr("data-cateid"), next: a.parents(".drop_cate").next().children().find(".category")};
            b.child.hasClass("active") || b.next.filter('[data-listid="' + b.cartid + '"]').is(":visible") || b.child.addClass("active").parent().siblings("li").children("h2").removeClass("active").parents(".drop_cate").next().children().children().children().filter('[data-listid="' + b.cartid + '"]').show("fast").siblings(".category").hide("fast")
        }}, k = {bindwindowCategory: function() {
            var a = {wH: $(window).innerHeight(), hH: $(".header").innerHeight(), tH: $(".thumb-mode").innerHeight(), lE: $(".u-pro-list").children().filter("dl").length};
            0 == window.orientation || 180 == window.orientation ? a.lE ? k.categoryStyle(a, .76) : k.categoryStyle(a, .5) : 90 == window.orientation || -90 == window.orientation ? k.categoryStyle(a, 1) : a.lE ? k.categoryStyle(a, .76) : k.categoryStyle(a, .5)
        }, categoryStyle: function(a, b) {
            return d.css({height: (a.wH - a.hH - a.tH) * b + "px"}), e.css({height: (a.wH - a.hH - a.tH) * b + "px"}), $(".drop_bottom").add($(".drop_bottom").children("a")).css({top: (a.wH - a.hH - a.tH) * b, height: a.wH - a.hH - a.tH - (a.wH - a.hH - a.tH) * b}), !1
        }, categoryEvent: function() {
            var a = new iScroll("B_cateWrap", {checkDOMChanges: !0, onScrollStart: function() {
                    a.refresh()
                }}), b = new iScroll("B_listWrap", {checkDOMChanges: !0, onScrollStart: function() {
                    b.refresh()
                }})
        }, cateInit: function() {
            d.length > 0 && k.categoryEvent()
        }}, l = {tiggerJumpLinks: function() {
            var a = $(this);
            dom = {elem: a, links: a.data("jumplink").toString()}, "" != dom.links && isNaN(dom.links) && VsmCart.VsmDialog("绑定钱包资金更安全，您确定放弃绑定吗？", {setClass: "ui-modal-doubleBtn", overClose: !1, buttons: !0, type: "defined", buttonsCus: [{name: "取消", attribute: !1}, {name: "确定", attribute: !0}], onDoComplete: function(a, b) {
                    b.oncomplete(!1)
                }, onDoCompleteTo: function(a, b) {
                    b.oncomplete(!1), self.location.href = dom.links
                }})
        }}, m = {bindEvents: function() {
            a.off("click.detail.loading").on("click.detail.loading", i.tiggerDetailinit), b.children().children().filter("a").off("click.made.classify").on("click.asyn.classify", j.slideCateinit), c.children().find("li").off("click.drop.menu").on("click.drop.menu", j.slideMenuinit), f.off("click.jump.link").on("click.jump.link", l.tiggerJumpLinks), g.children().filter("h3,p,.seledted_addr").off("click.accordion.down").on("click.accordion.down", i.tiggerAccordionInit)
        }, init: function() {
            m.bindEvents(), d.length > 0 && k.bindwindowCategory(), "index" === window.pageName && i.initPager()
        }};
    return{init: m.init, cateInit: k.cateInit, accordion: i.tiggerAccordion}
}(), VsmCart = function() {
    var a, b = {addZero: function(a, b) {
            return a && 10 > b ? b = "0" + b : b
        }, tiggerCartTime: function(c) {
            var d, e = {interval: 1e3, minDigit: !0, timeUnitCls: {day: "", hour: "", min: "", sec: ""}, showMsg: null, showMin: !0, timeStamp: !0, block: $("<span></span>"), action: "reload", jump: !1, timeTag: null, endTips: "", stopTips: "", timeWarn: !0, onEndCallBack: !1, onEndComplete: null}, f = $.extend(!0, {}, e, c), h = {}, i = c.elem;
            "string" == typeof f.time && (f.time = parseInt(f.time, 10)), !isNaN(f.time) && f.time > 0 && (h.startTime = f.time, h.nowTime = Math.round((new Date).getTime() / 1e3), h.endTime = h.nowTime + h.startTime, function j() {
                var c = {};
                if (null != f.timeTag)
                    var e = i.find(f.timeTag);
                else
                    var e = i;
                if (e.html(""), sec = h.nowTime < h.endTime ? h.endTime - h.nowTime : 0, null != f.showMsg && (c.msg = f.showMsg), f.showMin && (c.min = b.addZero(f.minDigit, Math.floor(sec / 60 % 60))), c.sec = b.addZero(f.minDigit, Math.floor(sec % 60)), !(h.endTime > h.nowTime)) {
                    if (f.stopTips)
                        d = f.stopTips, e.html(d);
                    else
                        switch (f.action) {
                            case"hide":
                                break;
                            case"remove":
                                break;
                            case"remain":
                                f.onEndCallBack && "function" == typeof f.onEndComplete && f.onEndComplete.call(i), !$('[data-getvercode="code"]').length && !$('[data-getvercode="code"]').length && g('<p style="text-align:center">可去购物车历史重新抢购哦！</p>', {setClass: "ui-modal-singleBtn", buttons: !0, type: "defined", overClose: !1, closeCover: "close-pop-cart-empty-imm-check_btn", buttonsCus: [{name: "立即查看", attribute: !0, mars_sead: "pop-cart-empty-imm-check_btn"}], onDoCompleteTo: function(a, b) {
                                        b.oncomplete(!1), self.location.href = "cart.html"
                                    }});
                                break;
                            case"defined":
                                f.onEndCallBack && "function" == typeof f.onEndComplete && f.onEndComplete.call(i);
                                break;
                            case"reload":
                                if (f.jump) {
                                    for (var k in c)
                                        c[k] = "00", f.block.clone().addClass(f.timeUnitCls[k]).text(c[k]).appendTo(e), f.timeStamp && f.block.clone().text(f.timeUnitCls[k]).appendTo(e);
                                    self.location.href = self.location.href
                                }
                        }
                    return clearTimeout(a), !1
                }
                f.endTips && (d = f.endTips);
                for (var k in c)
                    f.block.clone().addClass(f.timeUnitCls[k]).text(c[k]).appendTo(e), f.timeStamp && f.block.clone().text(f.timeUnitCls[k]).appendTo(e);
                h.nowTime = h.nowTime + f.interval / 1e3, a = setTimeout(j, f.interval), f.timeWarn && 300 === sec && !$('[data-OrderFrom="true"]').length && g('<p style="text-align:center">您的购物车只剩 <span class="c-red">5分钟</span> 时间，立即结算？</p>', {setClass: "ui-modal-doubleBtn", buttons: !0, type: "defined", overClose: !1, closeCover: "cart-close_btn", buttonsCus: [{name: "取消", attribute: !1, mars_sead: "cart-delete_btn"}, {name: "确定", attribute: !0, mars_sead: "cart-sure_btn"}], onDoComplete: function(a, b) {
                        b.oncomplete(!1)
                    }, onDoCompleteTo: function(a, b) {
                        b.oncomplete(!1), self.location.href = "cart.html"
                    }})
            }())
        }, CartTimereset: function() {
            void 0 == a ? "" : clearTimeout(a)
        }}, c = {tiggerDelBonus: function() {
            g("<p>确认取消使用礼券或优惠券吗？</p>", {setClass: "ui-modal-doubleBtn", overClose: !1, buttons: !0, type: "defined", buttonsCus: [{name: "取消", attribute: !1}, {name: "确定", attribute: !0}], onDoComplete: function(a, b) {
                    b.oncomplete(!1)
                }, onDoCompleteTo: function(a, b) {
                    b.oncomplete(!1), c.tiggerDelBonusDo()
                }})
        }, tiggerDelBonusDo: function() {
            $.get("index.php?m=flow&act=bonus&step=del", function(a) {
                1 == a.code && e.refreshAppCart()
            }, "json")
        }}, d = {min: 1, max: 12, NumshowMsg: function(a, b) {
            g(a, {width: "100%", position: [{top: "0"}, {left: "0"}], overShow: !1, autoClose: b})
        }, regNum: function(a) {
            return new RegExp("^[0-9]\\d*$").test(a)
        }, Amount: function(a, b) {
            var c = parseInt(a.text.text(), 10);
            return this.regNum(c) ? b ? c++ : c-- : (d.erDialog("请输入数字"), a.text.text(1)), c
        }, numReduce: function(a) {
            var b = $(a);
            dom = {elem: b, text: b.parent().children(".J_num_cart_txt"), brother: b.parent().children(".J_num_cart_add"), cart_id: parseInt(b.parent().data("product"))};
            var c = d.Amount(dom, !1);
            return dom.cart_id < 0 || "undefined" == dom.cart_id ? !1 : c >= d.min ? void $.ajax({url: "index.php?s=" + (new Date).getTime(), data: {m: "flow", act: "cart", step: "modify", cart_id: dom.cart_id, num: c}, dataType: "json", type: "POST", success: function(a) {
                    return null == a ? (d.reduceerDialog("未知错误，请刷新页面重试", dom), !1) : 1 != a.code ? -1 == a.code ? (d.erDialog(a.msg), !1) : (d.reduceerDialog(a.msg, dom), !1) : (dom.text.text(c), dom.brother.removeClass("good_data_num_r_act"), e.refreshAppCart(), void 0)
                }, error: function() {
                    d.reduceerDialog("网络加载延时，请刷新页面重试", dom)
                }}) : (d.reduceerDialog("最少购买数量为：" + d.min + "件", dom), !1)
        }, reduceerDialog: function(a, b) {
            d.erDialog(a), b.elem.removeClass("good_data_num_l_act"), b.elem.removeAttr("onClick")
        }, numAdd: function(a) {
            var b = $(a), c = {elem: b, text: b.parent().children(".J_num_cart_txt"), brother: b.parent().children(".J_num_cart_reduce"), cart_id: parseInt(b.parent().data("product"))};
            if (c.cart_id < 0 || "undefined" == c.cart_id)
                return!1;
            var f = d.Amount(c, !0);
            $.ajax({url: "index.php?s=" + (new Date).getTime(), data: {m: "flow", act: "cart", step: "modify", cart_id: c.cart_id, num: f}, dataType: "json", type: "POST", success: function(a) {
                    return null == a || "undefined" == a ? (d.adderDialog("未知错误，请刷新页面重试", c), !1) : 1 != a.code ? -1 == a.code ? (d.erDialog(a.msg), !1) : (d.adderDialog(a.msg, c), !1) : (c.text.text(f), c.brother.addClass("good_data_num_l_act"), e.refreshAppCart(), void 0)
                }, error: function() {
                    return d.adderDialog("网络加载延时，请刷新页面重试", c), !1
                }})
        }, adderDialog: function(a, b) {
            d.erDialog(a), b.elem.addClass("good_data_num_r_act"), b.elem.removeAttr("onClick")
        }, erDialog: function(a) {
            VsmCart.VsmDialog(a, {setClass: "ui-error", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3})
        }, tiggerDelGoods: function(a) {
            var b = arguments[1] ? parseInt(arguments[1]) : 0, c = "确定从购物车中删除该商品吗？";
            b > 0 && (c = "删除或修改商品后，可能会导致已使用的红包，不满足条件而被自动取消使用，是否继续操作？"), 0 > a && !isNaN(a) ? "" : g('<p style="text-align:center">' + c + "</p>", {setClass: "ui-modal-doubleBtn", overClose: !1, buttons: !0, type: "defined", onCloseCallBack: !0, buttonsCus: [{name: "取消", attribute: !1}, {name: "确定", attribute: !0}], onDoComplete: function(a, b) {
                    b.oncomplete(!1)
                }, onDoCompleteTo: function(b, c) {
                    c.oncomplete(!1), d.tiggerDelGoodsDo(a)
                }})
        }, tiggerDelGoodsDo: function(a) {
            $.post("index.php?m=flow&act=cart&step=del", {cart_id: a}, function(a) {
                1 == a.code ? e.refreshAppCart() : 0 == a.code ? VsmwebForm.dialogDialog(a.msg) : -1 == a.code && (self.location.href = self.location.href)
            }, "json")
        }}, e = {refreshAppCart: function() {
            f.close(), g({setClass: "ui-modal-loading", overClose: !1, closeBtn: !1, width: 100, height: 60, isLoading: !0}), $.ajax({url: "index.php?", data: {m: "flow", act: "cart"}, dataType: "json", type: "POST", success: function(a) {
                    if (f.close(), a && null != a && void 0 != a) {
                        if (a.out)
                            return $("#cart_list").html(a.out), h.imgBrandEffect(), b.CartTimereset(), void i.cartTimeCensor();
                        g("网络加载异常，请刷新页面重试!", {overClose: !1, closeBtn: !1})
                    } else
                        g("网络加载异常，请刷新页面重试!", {overClose: !1, closeBtn: !1})
                }, error: function() {
                    f.close(), g("网络加载异常，请刷新页面重试!", {overClose: !1, closeBtn: !1})
                }})
        }}, f = {getButtons: function(a) {
            if (a.buttons !== !0 && !$.isArray(a.buttons))
                return!1;
            if (a.buttons === !0)
                switch (a.type) {
                    case"question":
                        a.buttons = ["取消", "确定"];
                        break;
                    case"confirm":
                        a.buttons = ["取消", "确定"];
                        break;
                    case"submit":
                        a.buttons = ["取消", "提交"];
                        break;
                    case"ordersubmit":
                        a.buttons = ["取消", "确定"];
                        break;
                    case"defined":
                        a.buttons = null != a.buttonsCus ? a.buttonsCus : ["取消", "确定"];
                        break;
                    default:
                        a.buttons = ["确定"]
                }
            return a.buttons.reverse()
        }, getType: function(a) {
            switch (a.type) {
                case"confirm":
                case"error":
                case"info":
                case"question":
                case"warning":
                case"submit":
                case"ordersubmit":
                    return a.type.charAt(0).toUpperCase() + a.type.slice(1).toLowerCase();
                default:
                    return!1
                }
        }, tiggerhideOverload: function() {
            $("body,html").find(".modal-backdrop").fadeOut("fast", function() {
                $(this).remove()
            })
        }, close: function() {
            $("body,html").find(".modal").fadeOut("fast", function() {
                $(this).remove(), f.tiggerhideOverload()
            })
        }, init: function() {
            var a, b = {modal: null, modalHide: !1, width: 270, top: 43, animate_speed: "fast", effect: "fadeIn", autoClose: !1, setClass: !1, closeBtn: !1, buttons: !1, buttonsCus: null, position: "center", setPosition: 100, isCenter: !0, onShowCallback: void 0, onCloseCallBack: !1, onCloseComplete: null, onCancleComplete: null, centerMessage: !0, message: "", loading: '<span class="ui-clockout">							<span class="ui-clockin">							  <span class="ui-swing1"></span>							  <span class="ui-swing2"></span>							  <span class="ui-clockcirle"></span>							</span>						  </span>', type: null, title: null, source: !1, overAnimate: !0, overShow: !0, overClose: !0, overOpacity: .6}, c = this, d = {};
            "string" == typeof arguments[0] && (d.message = arguments[0]), ("object" == typeof arguments[0] || "object" == typeof arguments[1]) && (d = $.extend(d, "object" == typeof arguments[0] ? arguments[0] : arguments[1]));
            var e = $.extend(!0, {}, b, d);
            c.Init = function() {
                var b, d = isNaN(d) ? e.width : parseInt(e.width, 10);
                if (e.overShow && (c.overlayer = $("<div>", {"class": "modal-backdrop fade"}).css({top: 0, left: 0}), e.overClose && c.overlayer.on("click.overlayer.close", function() {
                    c.close()
                }), c.overlayer.appendTo(document.body), e.overAnimate ? c.overlayer.animate({opacity: e.overOpacity}) : c.overlayer.addClass("in")), null == e.modal) {
                    if (c.modal = $("<div>", {"class": "modal hide" + (e.setClass ? " " + e.setClass : "")}), d == e.width && d.toString() == e.width.toString() && c.modal.css({width: e.width}), !e.buttons && e.autoClose && c.modal.attr("data-modalindex", Math.floor(999999 * Math.random())), e.title && (b = $("<div>", {"class": "modal-header"}).html("<h3>" + e.title + "</h3>").appendTo(c.modal)), c.container = $("<div>", {"class": "modal-body" + (e.title ? "" : " modal-body-noTitle") + (f.getButtons(e) ? "" : " modal-body-noBotton")}).appendTo(c.modal), c.message = $("<div>", {"class": "modal-message" + ("" != f.getType(e) ? " modal-Icon modal-" + f.getType(e) : "")}), "" != e.message ? e.centerMessage ? $("<div>").html(e.message).appendTo(c.message) : c.message.html(e.message) : e.centerMessage ? $("<div>", {style: "text-align:center"}).html(e.loading).appendTo(c.message) : c.message.html(e.loading), e.source && "object" == typeof e.source) {
                        var h = e.centerMessage ? $("div:first", c.message) : c.message;
                        for (var i in e.source)
                            switch (i) {
                                case"ajax":
                                    var j = "string" == typeof e.source[i] ? {url: e.source[i]} : e.source[i], k = $("<div>", {"class": "modal-Preloader progress-striped active"}).html('<div class="bar"></div>').appendTo(h);
                                    j.success = function(a) {
                                        k.fadeOut(function() {
                                            h.append(a)
                                        }), g(!1)
                                    }, $.ajax(j);
                                    break;
                                case"iframe":
                                    var l = {width: "100%", height: "100%", marginheight: "0", marginwidth: "0", frameborder: "0"}, m = $.extend(!0, {}, l, "string" == typeof e.source[i] ? {src: e.source[i]} : e.source[i]);
                                    h.append($("<iframe>").attr(m));
                                    break;
                                case"inline":
                                    console.log(e.source[i]), h.append(e.source[i])
                                }
                    }
                    var n = f.getButtons(e);
                    if (n && (c.footer = $("<div>", {"class": "modal-footer"}).appendTo(c.modal), "question" == e.type ? $.each(n, function(a, b) {
                        var d = $("<a>", {href: "javascript:void(0)", "class": "btn", "data-dismiss": "modal"}).html(b);
                        "确定" === d.html() ? d.off("click.modal.close").on("click.modal.close", function() {
                            e.onDoComplete && "function" == typeof e.onDoComplete && e.onDoComplete($(this), {oncomplete: function(a) {
                                    a ? c.close(void 0 !== b.caption ? b.caption : b, a) : c.close()
                                }})
                        }) : d.off("click.modal.close").on("click.modal.close", function() {
                            c.close()
                        }), d.appendTo(c.footer)
                    }) : "confirm" == e.type ? $.each(n, function(a, b) {
                        var d = $("<a>", {href: "javascript:void(0)", "class": "btn", "data-dismiss": "modal"}).html(b);
                        "确定" === d.html() ? (d.attr("data-ConfirmForm", "true"), d.off("click.modal.close").on("click.modal.close", function() {
                            var a = $(this), d = {elem: a, Confirm: a.attr("data-ConfirmForm")};
                            void 0 === d.Confirm ? c.close() : c.close(void 0 !== b.caption ? b.caption : b, d.Confirm)
                        })) : d.off("click.modal.close").on("click.modal.close", function() {
                            c.close()
                        }), d.appendTo(c.footer)
                    }) : "submit" == e.type ? $.each(n, function(a, b) {
                        var d = $("<a>", {href: "javascript:void(0)", "class": "btn", "data-dismiss": "modal"}).html(b);
                        "提交" === d.html() ? (d.attr("data-submitForm", "true"), d.off("click.modal.close").on("click.modal.close", function() {
                            {
                                var a = $(this);
                                ({elem: a, Submit: a.attr("data-submitForm")})
                            }
                            e.onCloseComplete && "function" == typeof e.onCloseComplete && e.onCloseComplete(b, $(this))
                        })) : d.off("click.modal.close").on("click.modal.close", function() {
                            c.close()
                        }), d.appendTo(c.footer)
                    }) : "ordersubmit" == e.type ? $.each(n, function(a, b) {
                        var d = $("<a>", {href: "javascript:void(0)", "class": "btn", "data-dismiss": "modal"}).html(b);
                        "确定" === d.html() ? (d.attr("data-submitOrder", "true"), d.off("click.modal.close").on("click.modal.close", function() {
                            {
                                var a = $(this);
                                ({elem: a, Submit: a.attr("data-submitForm")})
                            }
                            e.onCloseCallBack && e.onCloseComplete && "function" == typeof e.onCloseComplete && e.onCloseComplete(b, $(this))
                        })) : (d.attr("data-modalCancle", "true"), d.off("click.modal.close").on("click.modal.close", function() {
                            {
                                var a = $(this);
                                ({elem: a, Cancle: a.attr("data-modalCancle")})
                            }
                            e.onCloseCallBack && e.onCancleComplete && "function" == typeof e.onCancleComplete ? e.onCancleComplete(b, $(this)) : c.close()
                        })), d.appendTo(c.footer)
                    }) : "defined" == e.type ? $.each(n, function(a, b) {
                        if ("object" == typeof b) {
                            var d = $("<a>", {href: "javascript:void(0)", "class": "btn", mars_sead: b.mars_sead, "data-dismiss": b.attribute}).html(b.name);
                            "boolean" != typeof d.data("dismiss") || d.data("dismiss") ? "boolean" == typeof d.data("dismiss") && d.data("dismiss") ? (2 === e.buttonsPos && d.addClass(e.buttonsStyle), d.off("click.modal.close").on("click.modal.close", function() {
                                e.onDoCompleteTo && "function" == typeof e.onDoCompleteTo && e.onDoCompleteTo($(this), {oncomplete: function(a) {
                                        a ? c.close($(this), a.toString()) : c.close()
                                    }})
                            })) : (e.buttonsPos > 2 && d.addClass(e.buttonsStyle), d.off("click.modal.close").on("click.modal.close", function() {
                                c.close()
                            })) : (1 === e.buttonsPos && d.addClass(e.buttonsStyle), d.off("click.modal.close").on("click.modal.close", function() {
                                e.onDoComplete && "function" == typeof e.onDoComplete && e.onDoComplete($(this), {oncomplete: function(a) {
                                        a ? c.close($(this), a.toString()) : c.close()
                                    }})
                            }))
                        } else {
                            var d = $("<a>", {href: "javascript:void(0)", "class": "btn", "data-dismiss": "modal"}).html(b);
                            d.off("click.modal.close").on("click.modal.close", function() {
                                c.close()
                            })
                        }
                        d.appendTo(c.footer)
                    }) : $.each(n, function(a, b) {
                        var d = $("<a>", {href: "javascript:void(0)", "class": "btn", "data-dismiss": "modal"}).html(b);
                        d.off("click.modal.close").on("click.modal.close", function() {
                            c.close()
                        }), d.appendTo(c.footer)
                    }), c.footer.appendTo(c.modal)), e.closeBtn) {
                        $('<a href="javascript:void(0)" class="closeBtn" ' + (e.closeCover && "" != e.closeCover ? 'mars_sead="' + e.closeCover + '"' : "") + "><span>×</span></a>").on("click.modal.closeBtn", function(a) {
                            a.preventDefault(), c.close()
                        }).prependTo(b ? b : c.message)
                    }
                    c.message.appendTo(c.container), c.modal.appendTo(document.body), $(window).on("resize.modal", function() {
                        clearTimeout(a), a = setTimeout(function() {
                            g()
                        }, 100)
                    })
                } else {
                    c.modal = $(e.modal);
                    var b = c.modal.children().filter(".modal-header");
                    if (d == e.width && d.toString() == e.width.toString() && c.modal.css({width: e.width}).addClass(e.setClass), e.closeBtn && !c.modal.find('[data-dismiss="closeModal"]').length) {
                        $('<a href="javascript:void(0)" class="closeBtn" data-dismiss="closeModal" mars_sead="home_province_close_btn">×</a>').off("click.modal.closeBtn").on("click.modal.closeBtn", function(a) {
                            a.preventDefault(), c.close()
                        }).prependTo(b)
                    } else
                        c.modal.find('[data-dismiss="closeModal"]').off("click.modal.closeBtn").on("click.modal.closeBtn", function(a) {
                            a.preventDefault(), c.close()
                        });
                    c.modal.undelegate("click.dismiss.modal").delegate('[data-dismiss="modal"]', "click.dismiss.modal", function() {
                        e.onDoComplete && "function" == typeof e.onDoComplete && e.onDoComplete($(this), {oncomplete: function() {
                                c.close()
                            }})
                    }), $(window).on("resize.modal", function() {
                        clearTimeout(a), a = setTimeout(function() {
                            g(!1)
                        }, 100)
                    })
                }
                return e.autoClose !== !1 && (c.modal.bind("click", function() {
                    clearTimeout(c.setTimes), c.close()
                }), c.setTimes = setTimeout(c.close, e.autoClose)), g(!1), "function" === $.type(e.onShowCallback) && e.onShowCallback.call(c), c
            }, c.close = function(a) {
                var b;
                $(window).off("resize.modal"), $(document).off("resize.modal"), b = arguments[1] ? arguments[1] : void 0, c.overlayer && c.overlayer.fadeOut(e.animate_speed, function() {
                    $(this).remove()
                }), "fadeIn" === e.effect ? c.modal.fadeOut(e.animate_speed, function() {
                    e.modalHide ? $(this).hide() : $(this).remove(), e.onCloseComplete && "function" == typeof e.onCloseComplete && b && "string" == typeof b && e.onCloseComplete(void 0 !== a ? a : "")
                }) : "animate" === e.effect && c.modal.animate({top: 0, opacity: 0}, e.animate_speed, function() {
                    e.modalHide ? $(this).hide() : $(this).remove(), e.onCloseComplete && "function" == typeof e.onCloseComplete && b && "string" == typeof b && e.onCloseComplete(void 0 !== a ? a : "")
                })
            };
            var g = function() {
                var a = $(window).width(), b = $(window).height(), d = c.modal.outerWidth(), f = c.modal.outerHeight(), g = {left: 0, top: 0, right: a - d, bottom: b - f, center: (a - d) / 2, middle: (b - f) / 2};
                c[0] = void 0, c[1] = void 0, $.isArray(e.position) && 2 == e.position.length && "object" == typeof e.position && $.each(e.position, function(a, b) {
                    $.each(b, function(b, d) {
                        c[a] = d + "px", c.modal.css(b, c[a]).fadeIn(e.animate_speed)
                    })
                }), (void 0 === c[0] || void 0 === c[1]) && (c[0] = g.center, c[1] = g.middle, "boolean" == typeof arguments[0] && arguments[0] === !1 || 0 === e.setPosition ? e.isCenter ? "fadeIn" === e.effect ? c.modal.css({left: c[0], top: c[1], visibility: "visible"}).fadeIn(e.animate_speed) : "animate" === e.effect && c.modal.css({left: c[0], top: "-25%", visibility: "visible", opacity: 0}).show().animate({left: c[0], top: c[1], opacity: 1}, e.animate_speed) : c.modal.css({left: c[0], top: e.top, visibility: "visible"}).fadeIn(e.animate_speed) : (c.modal.stop(!0), c.modal.css({left: c[0], visibility: "visible"}).animate({left: c[0], top: c[1]}, e.setPosition)))
            };
            return c.Init()
        }}, g = function(a, b, c) {
        return new f.init(a, b, c)
    }, h = {imgLoadEffect: function() {
            $(".J_lazy").lazyload({effect: "fadeIn", effect_speed: 100, threshold: 1e3}), $(".orderRlink img").lazyload({effect: "fadeIn", effect_speed: 100, threshold: 1e3})
        }, imgBrandEffect: function() {
            $("[data-brandlazy]").smartlazyload({effect: "fadeIn", effect_speed: 100, load: function() {
                    h.CheckLazyimage($(this), {oncomplete: function(a, b, c) {
                            this.width == this.height && 1 == this.width || this.width == this.height && 0 == this.width ? (a.hide(), a.attr("src", c).fadeIn("fast")) : a.attr("src", b).fadeIn("fast")
                        }})
                }}), window.scroll(0, 1), setTimeout(function() {
                window.scroll(0, 0)
            }, 1e3)
        }, imgNewEffect: function(a) {
            a.elem.prev().children().find("img." + a.cName).filter(":gt(" + (a.total - 1) + ")").smartlazyload({effect: "fadeIn", effect_speed: 100, load: function() {
                    h.CheckLazyimage($(this), {oncomplete: function(a, b, c) {
                            this.width == this.height && 1 == this.width || this.width == this.height && 0 == this.width ? (a.hide(), a.attr("src", c).fadeIn("fast")) : a.attr("src", b).fadeIn("fast")
                        }})
                }})
        }, CheckLazyimage: function(a, b) {
            var c = new Image, d = a.data("original"), e = a.data("onerror"), f = b.oncomplete;
            c.src = "string" == typeof d ? d : e, c.onload = c.onerror = c.onreadystatechange = function() {
                return c && c.readyState && "loaded" != c.readyState && "complete" != c.readyState ? !1 : void f.call({width: c.width, height: c.height}, a, d, e)
            }
        }}, i = {cartTimeCensor: function() {
            var a = $('[data-countdown="true"]'), c = {elem: a, time: parseInt(a.attr("data-cartTime")), jump: !0, timeTag: "span.count-time", endTips: "00:00", timeUnitCls: {day: "", hour: "", min: ":", sec: ""}};
            !isNaN(c.time) && c.time > 0 && b.tiggerCartTime(c)
        }, OrderTimeCensor: function() {
            var a = $('[data-countOrder="true"]'), c = {elem: a, time: parseInt(a.attr("data-orderTime")), showMin: !0, action: "remain", timeTag: "span.num_cunt", timeUnitCls: {day: "", hour: "", min: ":", sec: ""}, onEndCallBack: !0, onEndComplete: function() {
                    self.location.href = self.location.href
                }};
            !isNaN(c.time) && c.time > 0 && b.tiggerCartTime(c)
        }, PBcartTimeCensor: function() {
            var a = $('[data-cTime="true"]'), c = {elem: a, time: parseInt(a.attr("data-cartTime")), timeUnitCls: {day: "", hour: "", min: ":", sec: ""}, showMin: !0, action: "remain", onEndCallBack: !0, onEndComplete: function() {
                    this.add(this.prev().prev()).fadeOut(function() {
                        $(this).html("").prev().prev().html("")
                    })
                }};
            !isNaN(c.time) && c.time > 0 && b.tiggerCartTime(c)
        }}, j = {init: function() {
            i.cartTimeCensor(), i.OrderTimeCensor(), i.PBcartTimeCensor(), h.imgLoadEffect(), $("[data-brandlazy]").length && h.imgBrandEffect()
        }};
    return{init: j.init, refreshAppCart: e.refreshAppCart, delGoods: d.tiggerDelGoods, delBonus: c.tiggerDelBonus, addNum: d.numAdd, reduceNum: d.numReduce, VsmDialog: g, VsmDClose: f.close, imgNewEffect: h.imgNewEffect, countdown: b.tiggerCartTime, countclose: b.CartTimereset, countReset: b.CartTimereset, imgcheck: h.CheckLazyimage}
}(), VmPageEffect = function() {
    var a, b = ($("#scroller_lBer"), $("#scroller_lIcon"), $("#goods_images li")), c = $("img.Touch_mer_smallImg"), d = $("#pro_pagination"), e = $("img.Touch_mer_biglImg"), f = $("#accordion-category"), g = $('[data-clientdl="check"]'), h = $('[data-depot="true"]'), i = {tiggerDLlink: function() {
            var a = Cookie.Browser();
            a.isIPhone ? $('[data-clientdl="iphone"]').show().siblings(".down_iphone").hide() : a.isAndroid ? $('[data-clientdl="android"]').show().siblings(".down_iphone").hide() : $('[data-clientdl="check"]').show().siblings(".down_iphone").hide()
        }}, j = {tiggerDepotSet: function(a) {
            var b = a.dom, c = a.c, d = (a.type, Cookie.Get("warehouse"));
            Cookie.Set("m_vip_province", $(b.elem).attr("data_mars"), 26280, ".vip.com"), VIP.localStorage.getItem("changing_warehouse_type") || (VIP.localStorage.getItem("ip_modal_changing") ? $(b.elem).hasClass("J_guess_warehouse") ? VIP.localStorage.setItem("changing_warehouse_type", 5) : VIP.localStorage.setItem("changing_warehouse_type", 6) : $(b.elem).hasClass("J_guess_warehouse") ? VIP.localStorage.setItem("changing_warehouse_type", 2) : VIP.localStorage.setItem("changing_warehouse_type", 3));
            var e = VsmCart.VsmDialog('正切换至"' + decodeURI(b.area) + '"...', {width: "auto", overClose: !1, setClass: "ui-modal-black", buttons: !1, overShow: !1, closeBtn: !1});
            c && c.oncomplete(!0), $.ajax({url: "index.php?", data: {m: "ajax", act: "select_warehouse", wh: b.posi, p_area: b.area}, type: "POST", success: function(a) {
                    a && null != a && void 0 != a && d == b.posi ? (AdShowRule && AdShowRule(), e.close(), $(".J_nav_warehouse").show().find(".warehouse_txt").html(decodeURI(b.area))) : location.reload()
                }, error: function() {
                    VsmCart.VsmDialog("网络延时，请刷新页面重试", {setClass: "ui-error", position: [{top: 0}, {left: 0}], overClose: !1, overShow: !1, width: "100%", autoClose: 3e3}), e.close()
                }})
        }, tiggerDepotDo: function(a, b) {
            var c = a, d = {elem: c, area: encodeURI($.trim(c.text().toString())), posi: c.attr("data-positions").toString(), hascart: parseInt(c.parents("[data-hascart]").data("hascart")), Gcookie: Cookie.Get("WAP[p_wh]")};
            d.hascart && d.Gcookie !== d.posi ? VsmCart.VsmDialog("更换收货地址后，购物车将会被清空，是否确认需要更换？", {setClass: "ui-model-double", overClose: !1, buttons: !0, type: "defined", buttonsCus: [{name: "取消", attribute: !1}, {name: "确定", attribute: !0}], onDoComplete: function(a, b) {
                    b.oncomplete(!1)
                }, onDoCompleteTo: function(a, c) {
                    c.oncomplete(!1), d.posi && j.tiggerDepotSet({dom: d, c: b})
                }}) : d.posi && j.tiggerDepotSet({dom: d, c: b})
        }, tiggerDepotInit: function(a) {
            var b = arguments[1] ? arguments[1] : {}, c = VsmWebConfig.scroll();
            b.closeBtn ? b.closeBtn : b.closeBtn = !1, b.modalHide ? b.modalHide : b.modalHide = !1, $(a).length && !$(a).is(":visible") && (VsmCart.VsmDialog({modal: a, setClass: "ui-modal-fade", overClose: !1, width: "90%", isCenter: !1, top: 20, closeBtn: b.closeBtn, modalHide: b.modalHide, onDoComplete: function(a, b) {
                    j.tiggerDepotDo(a, b)
                }}), $(a).css({top: c.scrollTop + 90}))
        }, tiggerDepotBtn: function() {
            var a = $(this), b = {elem: a, obj: "#" + $("body,html").find("[data-modal]").attr("id"), closeBtn: !0, modalHide: !0};
            j.tiggerDepotInit(b.obj, b)
        }}, k = {triggerBoxStyle: function() {
            this.openObj.css({opacity: 0, position: "fixed", "z-index": 999, top: "0px", left: " 0px", height: "100%", width: "100%", background: "#000"}).show().addClass("open")
        }, triggerboxclose: function() {
            var a = this.openObj.children().children().filter("a.layer_close"), b = this.openObj;
            a.off("click.openboxclose").on("click.openboxclose", function() {
                $(this).remove(), b.fadeOut("fast")
            })
        }, triggerBoxOpen: function(a) {
            a.openObj.children().append(a.closeHtml), a.openObj.fadeTo(1e3, 1), window.Touch_bigImgReview = new Swipe(document.getElementById("bid_goods"), {startSlide: a.index, callback: function(b, c) {
                    index = c, e.eq(index).hasClass("active") || VsmCart.imgcheck(e.eq(index), {oncomplete: function(a, b, c) {
                            this.width == this.height && 1 == this.width || this.width == this.height && 0 == this.width ? a.attr("src", c).fadeIn(1e3).addClass("active") : a.attr("src", b).fadeIn(1e3).addClass("active")
                        }}), a.openObj.children().find("em").filter(":eq(" + index + ")").addClass("on").siblings().removeClass("on")
                }}), e.each(function() {
                VsmCart.imgcheck(e.filter(":eq(" + a.index + ")"), {oncomplete: function(a, b, c) {
                        this.width == this.height && 1 == this.width || this.width == this.height && 0 == this.width ? a.attr("src", c).fadeIn(1e3).addClass("active") : a.attr("src", b).fadeIn(1e3).addClass("active")
                    }}), $(this).bind("error", function() {
                    var a = e.index(this);
                    s.checkNote.call($(this), a)
                })
            }), a.openObj.children().find("em").filter(":eq(" + a.index + ")").addClass("on").siblings().removeClass("on"), k.triggerboxclose.call(a)
        }, triggeropenbox: function() {
            var a = $(this), c = {elem: a, index: b.index(this), openObj: $("#wapModalbbox"), closeHtml: '<a href="javascript:;" class="layer_close"><span><i></i></span></a>'};
            !c.openObj.hasClass("open") && k.triggerBoxStyle.call(c), k.triggerBoxOpen(c)
        }, FlickerNote: function(a, b, c, d, e) {
            var f = arguments[5] ? arguments[5] : !1, g = 0, h = !1, i = a.attr("class") || "", j = "", e = e || 2;
            a.hasClass(b) && a.removeClass(b), c ? a = a : a.children().filter(":eq(" + d + ")"), f && $("body,html").animate({scrollTop: a.offset().top - f}, 200), h || (h = setInterval(function() {
                g++, j = g % 2 ? i + " " + b : i, a.attr("class", j), g == 2 * e && (clearInterval(h), a.attr("class", i))
            }, 200))
        }}, l = {sliderMerchandise: function() {
            c.hide();
            {
                var a = document.getElementById("goods_images");
                d.children()
            }
            Touch_ImgReview = new Swipe(a, {callback: function(a, b) {
                    c.eq(b).hasClass("active") || c.eq(b).is(":visible") || VsmCart.imgcheck(c.eq(b), {oncomplete: function(a, b, c) {
                            this.width == this.height && 1 == this.width || this.width == this.height && 0 == this.width ? a.attr("src", c).fadeIn(1e3).addClass("active") : a.attr("src", b).fadeIn(1e3).addClass("active")
                        }}), d.children().eq(b).addClass("on").siblings().removeClass("on")
                }}), d.children().eq(0).addClass("on"), c.each(function() {
                VsmCart.imgcheck(c.filter(":eq(0)"), {oncomplete: function(a, b, c) {
                        this.width == this.height && 1 == this.width || this.width == this.height && 0 == this.width ? a.attr("src", c).fadeIn(1e3).addClass("active") : a.attr("src", b).fadeIn(1e3).addClass("active")
                    }}), $(this).bind("error", function() {
                    var a = c.index(this);
                    s.checkNote.call($(this), a)
                })
            })
        }, checkNote: function(a) {
            $merLimg.children().eq(a).remove(), this.parent().remove(), ImgReview.setup()
        }}, m = {buildOverlay: function() {
            $box_overlay.css({opacity: 0, "z-index": 1e4, width: $(window).innerWidth(), height: $(document).height(), background: "#000"})
        }, getScroll: function() {
            return self.pageYOffset ? {scrollTop: self.pageYOffset, scrollLeft: self.pageXOffset} : document.documentElement && document.documentElement.scrollTop ? {scrollTop: document.documentElement.scrollTop, scrollLeft: document.documentElement.scrollLeft} : document.body ? {scrollTop: document.body.scrollTop, scrollLeft: document.body.scrollLeft} : void 0
        }, boxBuild: function(a, b) {
            a.markup = a.markup.replace("{vmsTxt}", b.txt), a.markup = a.markup.replace("{vmsBtn}", b.btn), $("body").append(a.markup), $box_holder = $("div.ui-center-overlay"), $box_overlay = $("div.overlayer"), $box_holder.css({marginTop: -($box_holder.innerHeight() / 2), marginLeft: -($box_holder.innerWidth() / 2)}), m.buildOverlay()
        }, boxShowContent: function(a) {
            $box_overlay.show().fadeTo(a.animation, a.opacity), $box_holder.fadeIn(a.animation, function() {
            })
        }, boxInit: function(a) {
            var b = {autoplay: !0, allow_open: !0, modal: !1, opacity: .5, animation: "fast", markup: '<div id="ui-vsmbox"><div class="overlayer"></div><div class="ui-center-overlay" style="display:none;"><div class="ui-container">{vmsTxt}{vmsBtn}</div></div></div>'}, c = $.extend(!0, {}, b, a);
            m.boxBuild(c, a), m.boxShowContent(c)
        }}, n = {advertSlide: function() {
            VIP.util.initScrollAd({})
        }}, o = {triggerAccOpen: function() {
            1 === this.id ? (this.elem.addClass("open").next().slideDown().siblings().filter(".classified_cont").slideUp(), this.elem.siblings().removeClass("open")) : 2 === this.id && this.elem.addClass("open").next().slideToggle()
        }, triggerAccClose: function() {
            1 === this.id ? this.elem.removeClass("open").next().slideUp().siblings().filter(".classified_cont").slideUp() : 2 === this.id && this.elem.removeClass("open").next().slideToggle()
        }, triggerAccordion: function() {
            var a = $(this), b = {elem: a, next: a.next(), id: parseInt(a.parent().data("collapsed"), 10)};
            b.elem.hasClass("open") ? o.triggerAccClose.call(b) : o.triggerAccOpen.call(b)
        }}, p = {ProsizeEvent: function() {
            a = new iScroll("Size_wrapper", {checkDOMChanges: !0, onScrollStart: function() {
                    a.refresh()
                }})
        }, ProductGetData: function(b) {
            $.each(b, function(c) {
                b[c];
                b[c].content.length > 0 && "array" == b[c].type ? ($("#wap_Size_data").html($("#wap_sizeTemplate")), $("#wap_sizeTemplate").show(), $_tableStr = "", $.each(b[c].content, function(a, b) {
                    $_tableStr += "<tr>", $.each(b, function(a, b) {
                        $_tableStr += "" == b ? "<td>/</td>" : "<td>" + b + "</td>"
                    }), $_tableStr += "</tr>"
                }), $("#J_tableBody").prepend($_tableStr), b[c].tips.length > 0 && $("#J_size_tips").append(b[c].tips).removeClass("hidden")) : b[c].content.length > 0 && "html" == b[c].type ? ($("#wap_Size_data").html(b[c].content), $("#wap_Size_data").children().find("table").removeClass("table").addClass("wap_size_tab")) : ("error" == b[c].type || 0 == b[c].content) && $("#wap_Size_data").html('<p class="font14">此商品没有尺码</>');
                var d = $(".wap_size_tab").width();
                d > 500 && ($("#Size_scroller").removeClass("SizeScroller").addClass("SizeScroller_l"), a.refresh())
            })
        }, getMerSize: function() {
            var a = VsmwebForm.sizeDefault();
            $.ajax({url: a.wapDom.userUrl + "s=" + (new Date).getTime(), data: {act: a.wapDom.act, productid: a.wapDom.product_id, brandid: a.wapDom.brand_id}, dataType: "json", success: function(a) {
                    p.ProductGetData(a)
                }})
        }, cateInit: function() {
            $("#wap_Size_data").length && p.ProsizeEvent()
        }}, q = {resolveLocalHref: function(a) {
            var b = document.createElement("a");
            return b.href = a, {num: parseInt(/[0-4]{1}/g.exec(b.pathname), 10), source: a, file: (b.pathname.match(/\/([^\/?#]+)$/i) || [, ""])[1], query: b.search, params: function() {
                    for (var a, c = {}, d = b.search.replace(/^\?/, "").split("&"), e = d.length, f = 0; e > f; f++)
                        d[f] && (a = d[f].split("="), c[a[0]] = a[1]);
                    return c
                }()}
        }, channelCount: function(a) {
            $.ajax({url: "index.php?s=" + (new Date).getTime(), type: "GET", data: {v: ui, f: a, m: "ajexqd"}, dataType: "json", success: function() {
                }})
        }, channelLoad: function(a) {
            var b, c = {Channel: 0, url: null}, d = $.extend(!0, {}, c, a);
            d.Channel && null != d.url && (b = q.resolveLocalHref(d.url), b.params.f && q.channelCount(b.params.f))
        }}, r = {BindEvents: function() {
            b.off("click.openImages").on("click.openImages", k.triggeropenbox), f.children().filter(".class_tit").off("click.dropAccordion").on("click.dropAccordion", o.triggerAccordion), h.off("click.select.depot").on("click.select.depot", j.tiggerDepotBtn)
        }, BindBrowserEvents: function() {
//            var a = Cookie.Browser(), b = $("<div />", {"class": "ui-top-note"});
//            (void 0 == Cookie.Get("warehouse") || "undefined" == Cookie.Get("warehouse") || "" == Cookie.Get("warehouse")) && (0 != a.isSafari && "" != a.isSafari ? $(b).text("浏览器cookie被禁用，为了不影响您购物，请去设置中开启cookie！").prependTo("body") : $(b).text("浏览器cookie被禁用，为了不影响您购物，请去浏览器设置中开启cookie！").prependTo("body"))
       }}, t = {NeedtoCensor: function() {
            b.length && l.sliderMerchandise(), $("#CartCountdown").length && oP.cartTimerRun(), g.length && i.tiggerDLlink()
        }}, u = {init: function() {
            r.BindEvents(), r.BindBrowserEvents(), t.NeedtoCensor(), n.advertSlide()
        }};
    return{init: u.init, depot: j.tiggerDepotInit, iscroll: p.cateInit, sizePro: p.getMerSize, sharkError: k.FlickerNote, localUrl: q.resolveLocalHref, ChannelCount: q.channelCount, ChannelLoad: q.channelLoad, boxShow: m.boxInit, tiggerDepotSet: j.tiggerDepotSet}
}();
$(document).ready(function() {
    VsmFonEffect.init(), VsmwebEffect.init(), VsmCart.init(), VmPageEffect.init()
}), function(a, b) {
    var c = a(b);
    a.fn.smartlazyload = function(d) {
        function e() {
            var b = 0;
            g.each(function() {
                var c = a(this);
                if (!h.skip_invisible || c.is(":visible"))
                    if (a.abovethetop(this, h) || a.leftofbegin(this, h))
                        ;
                    else if (a.belowthefold(this, h) || a.rightoffold(this, h)) {
                        if (++b > h.failure_limit)
                            return!1
                    } else
                        c.trigger("appear"), h.ajax_getdata && "pad" == h.data_Version && "" != h.data_productid ? c.trigger("ajaxsize") : h.ajax_getdata && "touch" == h.data_Version && "" != h.data_productid ? c.trigger("touch_ajaxsize") : h.ajax_getdata && "Get_Merstar" == h.data_Type && "" == h.data_productid && c.trigger(h.data_Version + "_" + h.data_Type)
            })
        }
        var f, g = this, h = {threshold: 0, failure_limit: 0, event: "scroll", effect: "show", container: b, data_attribute: "original", error_attribute: "data-onerror", ajax_getdata: !1, data_Version: "pad", data_Type: "", data_productid: "", data_brandid: "", skip_invisible: !0, appear: null, load: null};
        return d && (void 0 !== d.failurelimit && (d.failure_limit = d.failurelimit, delete d.failurelimit), void 0 !== d.effectspeed && (d.effect_speed = d.effectspeed, delete d.effectspeed), a.extend(h, d)), f = void 0 === h.container || h.container === b ? c : a(h.container), 0 === h.event.indexOf("scroll") && f.bind(h.event, function() {
            e()
        }), this.each(function() {
            var b = this, c = a(b);
            b.loaded = !1, c.one("appear", function() {
                if (!this.loaded) {
                    if (h.appear) {
                        var d = g.length;
                        h.appear.call(b, d, h)
                    }
                    a("<img />").bind("load", function() {
                        a(this).addClass("dasdas"), c.hide().attr("src", c.data(h.data_attribute))[h.effect](h.effect_speed), b.loaded = !0;
                        var d = a.grep(g, function(a) {
                            return!a.loaded
                        });
                        if (g = a(d), h.load) {
                            var e = g.length;
                            h.load.call(b, e, h)
                        }
                    }).attr("src", c.data(h.data_attribute)), "" != h.error_attribute && a("<img />").bind("error", function() {
                        c.hide().attr("src", c.attr(h.error_attribute))[h.effect](h.effect_speed), b.loaded = !0;
                        a.grep(g, function(a) {
                            return!a.loaded
                        })
                    }).attr("src", c.data(h.data_attribute))
                }
            }), c.one("ajaxsize", function() {
                VmPageEffect.Profastsize(b, h)
            }), c.one("touch_ajaxsize", function() {
                TouchajaxGetdataSN(b, h)
            }), c.one(h.data_Version + "_" + h.data_Type, function() {
                VmPageEffect.star(b, h)
            }), 0 !== h.event.indexOf("scroll") && c.bind(h.event, function() {
                b.loaded || c.trigger("appear")
            })
        }), c.bind("resize", function() {
            e()
        }), e(), this
    }, a.belowthefold = function(d, e) {
        var f;
        return f = void 0 === e.container || e.container === b ? c.height() + c.scrollTop() : a(e.container).offset().top + a(e.container).height(), f <= a(d).offset().top - e.threshold
    }, a.rightoffold = function(d, e) {
        var f;
        return f = void 0 === e.container || e.container === b ? c.width() + c.scrollLeft() : a(e.container).offset().left + a(e.container).width(), f <= a(d).offset().left - e.threshold
    }, a.abovethetop = function(d, e) {
        var f;
        return f = void 0 === e.container || e.container === b ? c.scrollTop() : a(e.container).offset().top, f >= a(d).offset().top + e.threshold + a(d).height()
    }, a.leftofbegin = function(d, e) {
        var f;
        return f = void 0 === e.container || e.container === b ? c.scrollLeft() : a(e.container).offset().left, f >= a(d).offset().left + e.threshold + a(d).width()
    }, a.inviewport = function(b, c) {
        return!(a.rightofscreen(b, c) || a.leftofscreen(b, c) || a.belowthefold(b, c) || a.abovethetop(b, c))
    }, a.extend(a.expr[":"], {"below-the-fold": function(b) {
            return a.belowthefold(b, {threshold: 0})
        }, "above-the-top": function(b) {
            return!a.belowthefold(b, {threshold: 0})
        }, "right-of-screen": function(b) {
            return a.rightoffold(b, {threshold: 0})
        }, "left-of-screen": function(b) {
            return!a.rightoffold(b, {threshold: 0})
        }, "in-viewport": function(b) {
            return!a.inviewport(b, {threshold: 0})
        }, "above-the-fold": function(b) {
            return!a.belowthefold(b, {threshold: 0})
        }, "right-of-fold": function(b) {
            return a.rightoffold(b, {threshold: 0})
        }, "left-of-fold": function(b) {
            return!a.rightoffold(b, {threshold: 0})
        }})
}(jQuery, window), document.addEventListener("DOMContentLoaded", VsmwebEffect.cateInit, !1);